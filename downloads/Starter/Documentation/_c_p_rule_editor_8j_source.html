<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>API: AppKit/CPRuleEditor/CPRuleEditor.j Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">API
   &#160;<span id="projectnumber">0.9.8</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_c_p_rule_editor_8j_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CPRuleEditor.j</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_c_p_rule_editor_8j.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * CPRuleEditor.j</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * AppKit</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Created by cacaodev.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Copyright 2011, cacaodev.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;@global <a class="code" href="_c_p_comparison_predicate___constants_8j.html#a6ab35349aa74d616b383d93c178766b4">CPDirectPredicateModifier</a></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;@global <a class="code" href="_c_p_comparison_predicate___constants_8j.html#ac2d5c571c4be2735cfbd937426da8495">CPCaseInsensitivePredicateOption</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;@global <a class="code" href="_c_p_compound_predicate___constants_8j.html#aacd3c3aa70711bc73f82175b39341ddb">CPOrPredicateType</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="code" href="protocol_c_p_rule_editor_delegate-p.html">   31</a></span>&#160;<span class="keyword">@protocol </span><a class="code" href="protocol_c_p_rule_editor_delegate-p.html">CPRuleEditorDelegate</a> &lt;<a class="code" href="class_c_p_object.html">CPObject</a>&gt;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">@required</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;- (id)ruleEditor:(<a class="code" href="interface_c_p_rule_editor.html" title="A view for creating and configuring criteria. ">CPRuleEditor</a>)editor child:(CPInteger)index forCriterion:(<span class="keywordtype">id</span>)criterion withRowType:(CPRuleEditorRowType)rowType;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;- (id)ruleEditor:(<a class="code" href="interface_c_p_rule_editor.html" title="A view for creating and configuring criteria. ">CPRuleEditor</a>)editor displayValueForCriterion:(<span class="keywordtype">id</span>)criterion inRow:(CPInteger)row;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;- (CPInteger)ruleEditor:(<a class="code" href="interface_c_p_rule_editor.html" title="A view for creating and configuring criteria. ">CPRuleEditor</a>)editor numberOfChildrenForCriterion:(<span class="keywordtype">id</span>)criterion withRowType:(CPRuleEditorRowType)rowType;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">@optional</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;- (<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)ruleEditor:(<a class="code" href="interface_c_p_rule_editor.html" title="A view for creating and configuring criteria. ">CPRuleEditor</a>)editor predicatePartsForCriterion:(<span class="keywordtype">id</span>)criterion withDisplayValue:(<span class="keywordtype">id</span>)value inRow:(CPInteger)row;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;- (void)ruleEditorRowsDidChange:(<a class="code" href="interface_c_p_notification.html" title="A notification that can be posted to a CPNotificationCenter. ">CPNotification</a>)notification;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="code" href="_c_p_rule_editor_8j.html#a1c48877b4b05217ad6dc324164abb241">   44</a></span>&#160;var <a class="code" href="_c_p_rule_editor_8j.html#a1c48877b4b05217ad6dc324164abb241">CPRuleEditorDelegate_ruleEditor_predicatePartsForCriterion_withDisplayValue_inRow_</a>   = 1 &lt;&lt; 1;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="code" href="_c_p_rule_editor_8j.html#a981011b9de400af569604e903c3a05a7">   46</a></span>&#160;var <a class="code" href="_c_p_rule_editor_8j.html#a981011b9de400af569604e903c3a05a7">CPRuleEditorItemPBoardType</a>  = <span class="stringliteral">@&quot;CPRuleEditorItemPBoardType&quot;</span>,</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="code" href="_c_p_rule_editor_8j.html#a4f75c1ae12709156e424b601ca806c6e">   47</a></span>&#160;    <a class="code" href="_c_p_rule_editor_8j.html#a4f75c1ae12709156e424b601ca806c6e">itemsContext</a>                = <span class="stringliteral">&quot;items&quot;</span>,</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="code" href="_c_p_rule_editor_8j.html#a42fa15f29b9eab57eb3778f4ab02dfc2">   48</a></span>&#160;    <a class="code" href="_c_p_rule_editor_8j.html#a42fa15f29b9eab57eb3778f4ab02dfc2">valuesContext</a>               = <span class="stringliteral">&quot;values&quot;</span>,</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="code" href="_c_p_rule_editor_8j.html#a79dc5a73dd1ef67aa8ee8c953188cfee">   49</a></span>&#160;    <a class="code" href="_c_p_rule_editor_8j.html#a79dc5a73dd1ef67aa8ee8c953188cfee">subrowsContext</a>              = <span class="stringliteral">&quot;subrows_array&quot;</span>,</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="code" href="_c_p_rule_editor_8j.html#a8bff62fe6dcb4cc807b1a93164e5c46e">   50</a></span>&#160;    <a class="code" href="_c_p_rule_editor_8j.html#a8bff62fe6dcb4cc807b1a93164e5c46e">boundArrayContext</a>           = <span class="stringliteral">&quot;bound_array&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">@implementation </span><a class="code" href="interface_c_p_rule_editor.html" title="A view for creating and configuring criteria. ">CPRuleEditor</a> : <a class="code" href="interface_c_p_control.html">CPControl</a></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    BOOL                        _suppressKeyDownHandling;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    BOOL                        _allowsEmptyCompoundRows;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    BOOL                        _disallowEmpty;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    BOOL                        _delegateWantsValidation;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    BOOL                        _editable;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    BOOL                        _sendAction;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    Class                       _rowClass;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>                  _draggingRows;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    CPInteger                   _subviewIndexOfDropLine;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="interface_c_p_view.html">CPView</a>                      _dropLineView;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a>              _rowCache;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a>              _slices;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    CPPredicate                 _predicate;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>                    _itemsKeyPath;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>                    _subrowsArrayKeyPath;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>                    _typeKeyPath;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>                    _valuesKeyPath;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>                    _boundArrayKeyPath;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="interface_c_p_view.html">CPView</a>                      _slicesHolder;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="interface_c_p_view_animation.html">CPViewAnimation</a>             _currentAnimation;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    CPInteger                   _lastRow;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    CPInteger                   _nestingMode;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">float</span>                       _alignmentGridWidth;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">float</span>                       _sliceHeight;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">id</span>                          _ruleDataSource;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    id &lt;CPRuleEditorDelegate&gt;   _ruleDelegate;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">id</span>                          _boundArrayOwner;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">unsigned</span>                    _implementedDelegateMethods;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>                    _stringsFilename;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    BOOL                        _isKeyDown;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    BOOL                        _nestingModeDidChange;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    _CPRuleEditorLocalizer      _standardLocalizer;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>                _itemsAndValuesToAddForRowType;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;+ (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)defaultThemeClass</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">@&quot;rule-editor&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;+ (<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)themeAttributes</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> @{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="stringliteral">@&quot;alternating-row-colors&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="stringliteral">@&quot;selected-color&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="stringliteral">@&quot;slice-top-border-color&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="stringliteral">@&quot;slice-bottom-border-color&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="stringliteral">@&quot;slice-last-bottom-border-color&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="stringliteral">@&quot;font&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="stringliteral">@&quot;font-color&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="stringliteral">@&quot;add-image&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="stringliteral">@&quot;remove-image&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>],</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="stringliteral">@&quot;vertical-alignment&quot;</span>: [<a class="code" href="interface_c_p_null.html" title="An object representation of nil. ">CPNull</a> <a class="code" href="interface_c_p_null.html#a589123ee618828f2e89a5776409e1592">null</a>]</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        };</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;- (id)initWithFrame:(CGRect)frame</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span> !== nil)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        _slices = [[<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> alloc] init];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        _sliceHeight = 26.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        _nestingMode = <a class="code" href="_c_p_rule_editor___constants_8j.html#a6e943a157b214510f90ee395c7c5f246">CPRuleEditorNestingModeSimple</a>; <span class="comment">// 10.5 default is CPRuleEditorNestingModeCompound</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        _editable = YES;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        _allowsEmptyCompoundRows = NO;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        _disallowEmpty = NO;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        [<span class="keyword">self</span> setFormattingStringsFilename:nil];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        [<span class="keyword">self</span> setCriteriaKeyPath:@&quot;criteria&quot;];</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        [<span class="keyword">self</span> setSubrowsKeyPath:@&quot;subrows&quot;];</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        [<span class="keyword">self</span> setRowTypeKeyPath:@&quot;rowType&quot;];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        [<span class="keyword">self</span> setDisplayValuesKeyPath:@&quot;displayValues&quot;];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        [<span class="keyword">self</span> setBoundArrayKeyPath:@&quot;boundArray&quot;];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        _slicesHolder = [[_CPRuleEditorViewSliceHolder alloc] initWithFrame:[<span class="keyword">self</span> bounds]];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        [<span class="keyword">self</span> addSubview:_slicesHolder];</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        _boundArrayOwner = [[_CPRuleEditorViewUnboundRowHolder alloc] init];</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        [<span class="keyword">self</span> _initRuleEditorShared];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;- (void)_initRuleEditorShared</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    _rowCache = [[<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> alloc] init];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    _rowClass = [_CPRuleEditorRowObject class];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    _isKeyDown = NO;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    _subviewIndexOfDropLine = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    _lastRow = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    _delegateWantsValidation = YES;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    _suppressKeyDownHandling = NO;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    _nestingModeDidChange = NO;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    _sendAction = YES;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    _itemsAndValuesToAddForRowType = {};</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    var animation = [[<a class="code" href="interface_c_p_view_animation.html">CPViewAnimation</a> <a class="code" href="class_c_p_object.html#aa6d290852c6a151058e8e82d053db475">alloc</a>] <a class="code" href="interface_c_p_animation.html#a51ac5696ab2f2cba707d8cc525e112df">initWithDuration</a>:0.5 <a class="code" href="interface_c_p_animation.html#a51ac5696ab2f2cba707d8cc525e112df">animationCurve</a>:CPAnimationEaseInOut];</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    [<span class="keyword">self</span> setAnimation:animation];</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    [_slicesHolder setAutoresizingMask:CPViewWidthSizable | CPViewHeightSizable];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    _dropLineView =  [<span class="keyword">self</span> _createSliceDropSeparator];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    [_slicesHolder addSubview:_dropLineView];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    [<span class="keyword">self</span> registerForDraggedTypes:[CPArray arrayWithObjects:CPRuleEditorItemPBoardType,nil]];</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    [_boundArrayOwner addObserver:self forKeyPath:_boundArrayKeyPath options:CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew context:boundArrayContext];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ab0fe520d8dd618be6a4d3054030a5aff">  209</a></span>&#160;- (id)<a class="code" href="_c_a_layer_8j.html#a6c98e239b6ba279cfc95c64db9de555c">delegate</a></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     <span class="keywordflow">return</span> _ruleDelegate;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a6d25448378723eb381b866eda37de750">  220</a></span>&#160;- (void)setDelegate:(<span class="keywordtype">id</span> &lt;<a class="code" href="protocol_c_p_rule_editor_delegate-p.html">CPRuleEditorDelegate</a>&gt;)aDelegate</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;{</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (_ruleDelegate === aDelegate)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    var nc = [<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects. ">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (_ruleDelegate)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        [nc removeObserver:_ruleDelegate name:nil object:self];</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    _ruleDelegate = aDelegate;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    _implementedDelegateMethods = 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> ([_ruleDelegate respondsToSelector:<span class="keyword">@selector</span>(ruleEditorRowsDidChange:)])</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        [nc addObserver:_ruleDelegate selector:@selector(ruleEditorRowsDidChange:) name:CPRuleEditorRowsDidChangeNotification object:nil];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> ([_ruleDelegate respondsToSelector:<span class="keyword">@selector</span>(ruleEditor:predicatePartsForCriterion:withDisplayValue:inRow:)])</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        _implementedDelegateMethods |= <a class="code" href="_c_p_rule_editor_8j.html#a1c48877b4b05217ad6dc324164abb241">CPRuleEditorDelegate_ruleEditor_predicatePartsForCriterion_withDisplayValue_inRow_</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#acfb7505c72699bbef5a295470d8ee9ae">  245</a></span>&#160;- (BOOL)isEditable</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> _editable;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#abc274fb42baf71317ec622a6e2b39d05">  255</a></span>&#160;- (void)setEditable:(BOOL)editable</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (editable === _editable)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    _editable = editable;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (!_editable)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        [<span class="keyword">self</span> _deselectAll];</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    [_slices makeObjectsPerformSelector:@selector(setEditable:) withObject:_editable];</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a4f3924389299bef20617f554b11c79e5">  273</a></span>&#160;- (CPRuleEditorNestingMode)nestingMode</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     <span class="keywordflow">return</span> _nestingMode;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a675d4f35ffcf5805df0868798010696d">  285</a></span>&#160;- (void)setNestingMode:(CPRuleEditorNestingMode)mode</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (mode !== _nestingMode)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        _nestingMode = mode;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> ([<span class="keyword">self</span> numberOfRows] &gt; 0)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            _nestingModeDidChange = YES;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a376ed93b597996c0fd14f515d8e81b8e">  300</a></span>&#160;- (BOOL)canRemoveAllRows</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> !_disallowEmpty;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a4cfddb1834c185f9b12867c8741332df">  310</a></span>&#160;- (void)setCanRemoveAllRows:(BOOL)canRemove</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    _disallowEmpty = !canRemove;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    [<span class="keyword">self</span> _updateButtonVisibilities];</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#af672676e9b65275753e8f70b58e3ada4">  321</a></span>&#160;- (BOOL)allowsEmptyCompoundRows</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">return</span> _allowsEmptyCompoundRows;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a6adaf885b827356ea5855ca43436cf97">  331</a></span>&#160;- (void)setAllowsEmptyCompoundRows:(BOOL)allows</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;{</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    _allowsEmptyCompoundRows = allows;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    [<span class="keyword">self</span> _updateButtonVisibilities];</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a36b65c5bd2211ea714b1b472f3e29868">  342</a></span>&#160;- (CPInteger)rowHeight</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">return</span> _sliceHeight;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a3a4b774adc3569c303f3217abbe1a551">  352</a></span>&#160;- (void)setRowHeight:(<span class="keywordtype">float</span>)height</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (height === _sliceHeight)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    _sliceHeight = MAX([<span class="keyword">self</span> _minimumFrameHeight], height);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    [<span class="keyword">self</span> _reconfigureSubviewsAnimate:NO];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a01739614d3a058b5927f9f5286b28111">  371</a></span>&#160;- (<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)formattingDictionary</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> [_standardLocalizer dictionary];</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a8806008e62153f264c7a32af5b855d47">  383</a></span>&#160;- (void)setFormattingDictionary:(<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)dictionary</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    [_standardLocalizer setDictionary:dictionary];</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    _stringsFilename = nil;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ab19d14c9ce677cc933d43852e09cb674">  394</a></span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)formattingStringsFilename</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;{</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">return</span> _stringsFilename;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#abf7c4e09bbeb539a7df6c0434a896ece">  406</a></span>&#160;- (void)setFormattingStringsFilename:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)stringsFilename</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;{</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (_standardLocalizer === nil)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        _standardLocalizer = [_CPRuleEditorLocalizer new];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (_stringsFilename !== stringsFilename)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="comment">// Convert an empty string to nil</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        _stringsFilename = stringsFilename || nil;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">if</span> (stringsFilename !== nil)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> (![stringsFilename hasSuffix:<span class="stringliteral">@&quot;.strings&quot;</span>])</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                stringsFilename = stringsFilename + <span class="stringliteral">@&quot;.strings&quot;</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            var path = [[<a class="code" href="interface_c_p_bundle.html">CPBundle</a> <a class="code" href="interface_c_p_bundle.html#a2f1b74bb845caded5d4d8a1309c7ff0e">mainBundle</a>] <a class="code" href="interface_c_p_bundle.html#a09f6fb5fbe8e49ca2577b82af1c3ffa2">pathForResource</a>:stringsFilename];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">if</span> (path !== nil)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                [_standardLocalizer loadContentOfURL:[<a class="code" href="interface_c_p_u_r_l.html">CPURL</a> <a class="code" href="interface_c_p_u_r_l.html#aa3eeb979789d9141888dccc3227eda01">URLWithString</a>:path]];</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#aec52b04c0235711e93ec3e9669793afb">  437</a></span>&#160;- (void)reloadCriteria</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;{</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    var current_rows = [_boundArrayOwner valueForKey:_boundArrayKeyPath];</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    [<span class="keyword">self</span> _stopObservingRowObjectsRecursively:current_rows];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    [_boundArrayOwner setValue:[CPArray arrayWithArray:current_rows] forKey:_boundArrayKeyPath];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#abd2fa92df20dd94d12accf99a4d87b21">  452</a></span>&#160;- (void)setCriteria:(CPArray)criteria andDisplayValues:(CPArray)values forRowAtIndex:(<span class="keywordtype">int</span>)rowIndex</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (criteria === nil || values === nil)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPInvalidArgumentException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:_cmd + @&quot;. criteria and values parameters must not be nil.&quot;];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (rowIndex &lt; 0 || rowIndex &gt;= [<span class="keyword">self</span> numberOfRows])</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPRangeException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:_cmd + @&quot;. rowIndex is out of bounds.&quot;];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    var rowObject = [[<span class="keyword">self</span> _rowCacheForIndex:rowIndex] rowObject];</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    [rowObject setValue:criteria forKey:_itemsKeyPath];</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    [rowObject setValue:values forKey:_valuesKeyPath];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#aec52b04c0235711e93ec3e9669793afb" title="Instructs the receiver to refetch criteria from its delegate.  You can use this method to indicate th...">reloadCriteria</a>];</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a4ff74ef312afdca57e63b737a23e467f">  473</a></span>&#160;- (id)criteriaForRow:(CPInteger)row</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    var rowcache = [<span class="keyword">self</span> _rowCacheForIndex:row];</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (rowcache)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">return</span> [[rowcache rowObject] valueForKey:_itemsKeyPath];</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">return</span> nil;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#afc89e3b21d7eb34cbb7a00caae07b670">  492</a></span>&#160;- (<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a>)displayValuesForRow:(CPInteger)row</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;{</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    var rowcache = [<span class="keyword">self</span> _rowCacheForIndex:row];</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (rowcache)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">return</span> [[rowcache rowObject] valueForKey:_valuesKeyPath];</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> nil;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ae04204db2d684515060528c21cbabde2">  505</a></span>&#160;- (int)numberOfRows</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;     <span class="keywordflow">return</span> [_slices count];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ab93cd69dd87e7cf207fd6e7aaa4c1c8b">  515</a></span>&#160;- (int)parentRowForRow:(CPInteger)rowIndex</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;{</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (rowIndex &lt; 0 || rowIndex &gt;= [<span class="keyword">self</span> numberOfRows])</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPRangeException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:_cmd + @&quot; row &quot; + rowIndex + &quot; is out of range&quot;];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    var targetObject = [[<span class="keyword">self</span> _rowCacheForIndex:rowIndex] rowObject];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">for</span> (var current_index = 0; current_index &lt; rowIndex; current_index++)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span> ([<span class="keyword">self</span> rowTypeForRow:current_index] === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            var candidate = [[<span class="keyword">self</span> _rowCacheForIndex:current_index] rowObject],</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                subObjects = [[<span class="keyword">self</span> _subrowObjectsOfObject:candidate] _representedObject];</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">if</span> ([subObjects indexOfObjectIdenticalTo:targetObject] !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keywordflow">return</span> current_index;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">TODO: implement</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">    Returns the index of the row containing a given value.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">    displayValue The display value (string, view, or menu item) of an item in the receiver. This value must not be nil.</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">    The index of the row containing displayValue, or CPNotFound.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">    This method searches each row via objects equality for the given display value, which may be present as an alternative in a popup menu for that row.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">- (CPInteger)rowForDisplayValue:(id)displayValue</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a45acb7190d5d1eb0fbcb4c41e5794fc1">  556</a></span>&#160;- (CPRuleEditorRowType)rowTypeForRow:(CPInteger)rowIndex</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (rowIndex &lt; 0 || rowIndex &gt; [<span class="keyword">self</span> numberOfRows])</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPRangeException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:_cmd + @&quot;row &quot; + rowIndex + &quot; is out of range&quot;];</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    var rowcache = [<span class="keyword">self</span> _rowCacheForIndex:rowIndex];</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span> (rowcache)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        var rowobject = [rowcache rowObject];</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">return</span> [rowobject valueForKey:_typeKeyPath];</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a220df4affb327a1c0ceb8cae365704e1">  577</a></span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)subrowIndexesForRow:(CPInteger)rowIndex</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;{</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    var object;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (rowIndex === -1)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordtype">object</span> = _boundArrayOwner;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordtype">object</span> = [[<span class="keyword">self</span> _rowCacheForIndex:rowIndex] rowObject];</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    var subobjects = [<span class="keyword">self</span> _subrowObjectsOfObject:object],</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        objectsCount = [subobjects count],</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        indexes = [<a class="code" href="class_c_p_mutable_index_set.html">CPMutableIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>],</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        count = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#ae04204db2d684515060528c21cbabde2" title="Returns the number of rows in the receiver. ">numberOfRows</a>];</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">for</span> (var i = rowIndex + 1; i &lt; count; i++)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        var candidate = [[<span class="keyword">self</span> _rowCacheForIndex:i] rowObject],</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            indexInSubrows = [[subobjects _representedObject] indexOfObjectIdenticalTo:candidate];</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (indexInSubrows !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            [indexes addIndex:i];</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            objectsCount--;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">if</span> ([<span class="keyword">self</span> rowTypeForRow:i] === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                i += [[<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a220df4affb327a1c0ceb8cae365704e1" title="Returns the immediate subrows of a given row. ">subrowIndexesForRow</a>:i] <a class="code" href="interface_c_p_index_set.html#a837688ed946ca09c66595dfa30345d03">count</a>];</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">if</span> (objectsCount === 0)</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">return</span> indexes;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a4bd4b6653c92ab8340466b760b9cc94d">  616</a></span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)selectedRowIndexes</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> _selectedSliceIndices];</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a150f4150a622303e7fa6a235cb215bc6">  626</a></span>&#160;- (void)selectRowIndexes:(<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)indexes byExtendingSelection:(BOOL)extend</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;{</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    var count = [_slices count],</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        lastSelected = [indexes <a class="code" href="interface_c_p_index_set.html#a2a6418c6d61b8d5d993c2e2572935758">lastIndex</a>];</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> (lastSelected &gt;= [<span class="keyword">self</span> numberOfRows])</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPRangeException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:@&quot;row indexes &quot; + indexes + &quot; are out of range&quot;];</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> (!extend)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        [<span class="keyword">self</span> _deselectAll];</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">while</span> (count--)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        var slice = _slices[count],</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            rowIndex = [slice rowIndex],</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            contains = [indexes <a class="code" href="interface_c_p_index_set.html#a344d091793a5e263f37e26e94e9c31aa">containsIndex</a>:rowIndex],</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            shouldSelect = (contains &amp;&amp; !(extend &amp;&amp; [slice _isSelected]));</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span> (contains)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            [slice _setSelected:shouldSelect];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        [slice _setLastSelected:(rowIndex === lastSelected)];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        [slice setNeedsDisplay:YES];</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ab923818ed3706a4cbc2531b71667f41a">  660</a></span>&#160;- (void)addRow:(<span class="keywordtype">id</span>)sender</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;{</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    var parentRowIndex = -1,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        rowtype,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        numberOfRows = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#ae04204db2d684515060528c21cbabde2" title="Returns the number of rows in the receiver. ">numberOfRows</a>],</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        hasRows = (numberOfRows &gt; 0),</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        nestingMode = [<span class="keyword">self</span> _applicableNestingMode];</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">switch</span> (nestingMode)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#a6e943a157b214510f90ee395c7c5f246">CPRuleEditorNestingModeSimple</a>:</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            rowtype = hasRows ? <a class="code" href="_c_p_rule_editor___constants_8j.html#a049ce9c9baea351773da40b980e9ebb8">CPRuleEditorRowTypeSimple</a> : <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">if</span> (hasRows)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                parentRowIndex = 0;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#ae08c736e778a1a4411ebcef390bfb791">CPRuleEditorNestingModeSingle</a>:</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;             <span class="keywordflow">if</span> (hasRows)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#abc68a04af6ac9e1280f2087c8e9d3e2f">CPRuleEditorNestingModeList</a>:</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            rowtype = <a class="code" href="_c_p_rule_editor___constants_8j.html#a049ce9c9baea351773da40b980e9ebb8">CPRuleEditorRowTypeSimple</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#a2a2a2daaeed7ae8098015683fbe9a8cd">CPRuleEditorNestingModeCompound</a>:</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            rowtype = <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">if</span> (hasRows)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                parentRowIndex = 0;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPInvalidArgumentException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:@&quot;Not supported CPRuleEditorNestingMode &quot; + nestingMode];</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="comment">// Compound mode: parentRowIndex=(lastRowType === CPRuleEditorRowTypeCompound)?lastRow :[self parentRowForRow:lastRow]; break;</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a0925651149035b5be4473d79b6f8720b" title="Adds a new row of a given type at a given location. ">insertRowAtIndex</a>:numberOfRows <a class="code" href="interface_c_p_rule_editor.html#a0925651149035b5be4473d79b6f8720b" title="Adds a new row of a given type at a given location. ">withType</a>:rowtype <a class="code" href="interface_c_p_rule_editor.html#a0925651149035b5be4473d79b6f8720b" title="Adds a new row of a given type at a given location. ">asSubrowOfRow</a>:parentRowIndex <a class="code" href="interface_c_p_rule_editor.html#a0925651149035b5be4473d79b6f8720b" title="Adds a new row of a given type at a given location. ">animate</a>:YES];</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;}</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a0925651149035b5be4473d79b6f8720b">  703</a></span>&#160;- (void)insertRowAtIndex:(<span class="keywordtype">int</span>)rowIndex withType:(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)rowType asSubrowOfRow:(CPInteger)parentRow animate:(BOOL)shouldAnimate</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;{</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">    TODO: raise exceptions if parentRow is greater than or equal to rowIndex, or if rowIndex would fall amongst the children of some other parent, or if the nesting mode forbids this configuration.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    var newObject = [<span class="keyword">self</span> _insertNewRowAtIndex:rowIndex ofType:rowType withParentRow:parentRow];</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> (rowType === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a> &amp;&amp; !_allowsEmptyCompoundRows)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        var subrow = [<span class="keyword">self</span> _insertNewRowAtIndex:(rowIndex + 1) ofType:CPRuleEditorRowTypeSimple withParentRow:rowIndex];</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;}</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a234186347dbec09e509b234b7db3ed41">  722</a></span>&#160;- (void)removeRowAtIndex:(<span class="keywordtype">int</span>)rowIndex</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;{</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">//  TO DO : Any subrows of the deleted row are adopted by the parent of the deleted row, or are made root rows.</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> (rowIndex &lt; 0 || rowIndex &gt;= [<span class="keyword">self</span> numberOfRows])</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPRangeException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:@&quot;row &quot; + rowIndex + &quot; is out of range&quot;];</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a3585a56e119d23de73e740d642c39558" title="Removes the rows at a given index. ">removeRowsAtIndexes</a>:[<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:rowIndex] <a class="code" href="interface_c_p_rule_editor.html#a3585a56e119d23de73e740d642c39558" title="Removes the rows at a given index. ">includeSubrows</a>:NO];</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;}</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a3585a56e119d23de73e740d642c39558">  739</a></span>&#160;- (void)removeRowsAtIndexes:(<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)rowIndexes includeSubrows:(BOOL)includeSubrows</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;{</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> ([rowIndexes count] === 0)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> ([rowIndexes lastIndex] &gt;= [<span class="keyword">self</span> numberOfRows])</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPRangeException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:@&quot;rows indexes &quot; + rowIndexes + &quot; are out of range&quot;];</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    var current_index = [rowIndexes <a class="code" href="interface_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>],</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        parentRowIndex = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#ab93cd69dd87e7cf207fd6e7aaa4c1c8b" title="Returns the index of the parent of a given row. ">parentRowForRow</a>:current_index],</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        childsIndexes = [<a class="code" href="class_c_p_mutable_index_set.html">CPMutableIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>],</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        subrows;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> (parentRowIndex === -1)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        subrows = [<span class="keyword">self</span> _rootRowsArray];</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        var parentRowObject = [[<span class="keyword">self</span> _rowCacheForIndex:parentRowIndex] rowObject];</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        subrows = [<span class="keyword">self</span> _subrowObjectsOfObject:parentRowObject];</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        var rowObject = [[<span class="keyword">self</span> _rowCacheForIndex:current_index] rowObject],</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            relativeChildIndex = [[subrows _representedObject] indexOfObjectIdenticalTo:rowObject];</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">if</span> (relativeChildIndex !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            [childsIndexes addIndex:relativeChildIndex];</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">if</span> (includeSubrows &amp;&amp; [<span class="keyword">self</span> rowTypeForRow:current_index] === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            var more_childs = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a220df4affb327a1c0ceb8cae365704e1" title="Returns the immediate subrows of a given row. ">subrowIndexesForRow</a>:current_index];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a3585a56e119d23de73e740d642c39558" title="Removes the rows at a given index. ">removeRowsAtIndexes</a>:more_childs <a class="code" href="interface_c_p_rule_editor.html#a3585a56e119d23de73e740d642c39558" title="Removes the rows at a given index. ">includeSubrows</a>:includeSubrows];</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        current_index = [rowIndexes <a class="code" href="interface_c_p_index_set.html#a3f66583eea02c42c2b14e53daf697559">indexGreaterThanIndex</a>:current_index];</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    [subrows removeObjectsAtIndexes:childsIndexes];</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;}</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#adeb7f88eb5471420652fefe12955777e">  789</a></span>&#160;- (CPPredicate)predicate</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;{</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> _predicate;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a7e9942eb2e734935281e054050942594">  798</a></span>&#160;- (void)reloadPredicate</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;{</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    [<span class="keyword">self</span> _updatePredicate];</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;}</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#adcb69649e31ce9df98481f2f290a01da">  809</a></span>&#160;- (CPPredicate)predicateForRow:(CPInteger)aRow</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;{</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    var predicateParts = @{},</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        items = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a4ff74ef312afdca57e63b737a23e467f" title="Returns the currently chosen items for a given row. ">criteriaForRow</a>:aRow],</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        count = [items count],</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        predicate,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        i;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        var item = [items objectAtIndex:i],</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">//var displayValue = [self _queryValueForItem:item inRow:aRow]; Ask the delegate or get cached value ?.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            displayValue = [[<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#afc89e3b21d7eb34cbb7a00caae07b670" title="Returns the chosen values for a given row. ">displayValuesForRow</a>:aRow] objectAtIndex:i],</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            predpart = [<span class="keyword">self</span> _sendDelegateRuleEditorPredicatePartsForCriterion:item withDisplayValue:displayValue inRow:aRow];</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">if</span> (predpart)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            [predicateParts addEntriesFromDictionary:predpart];</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordflow">if</span> ([<span class="keyword">self</span> rowTypeForRow:aRow] === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        var compoundPredicate,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            subpredicates = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            subrowsIndexes = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#a220df4affb327a1c0ceb8cae365704e1" title="Returns the immediate subrows of a given row. ">subrowIndexesForRow</a>:aRow];</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span> ([subrowsIndexes count] === 0)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">return</span> nil;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        var current_index = [subrowsIndexes firstIndex];</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            var subpredicate = [<span class="keyword">self</span> <a class="code" href="interface_c_p_rule_editor.html#adcb69649e31ce9df98481f2f290a01da" title="Returns the predicate for a given row. ">predicateForRow</a>:current_index];</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">if</span> (subpredicate !== nil)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                [subpredicates addObject:subpredicate];</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            current_index = [subrowsIndexes indexGreaterThanIndex:current_index];</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        var compoundType = [predicateParts objectForKey:CPRuleEditorPredicateCompoundType];</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">if</span> ([subpredicates count] === 0)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">return</span> nil;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                compoundPredicate = [[<a class="code" href="interface_c_p_compound_predicate.html" title="CPCompoundPredicate is a subclass of CPPredicate used to represent logical gate operations (AND/OR/...">CPCompoundPredicate</a> alloc ] initWithType:compoundType subpredicates:subpredicates];</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keywordflow">catch</span>(error)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                CPLogConsole(<span class="stringliteral">@&quot;Compound predicate error: [%@]\npredicateType:%i&quot;</span>, [error description], compoundType);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                compoundPredicate = nil;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">finally</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                <span class="keywordflow">return</span> compoundPredicate;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    var lhs = [predicateParts objectForKey:CPRuleEditorPredicateLeftExpression],</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        rhs = [predicateParts objectForKey:CPRuleEditorPredicateRightExpression],</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keyword">operator</span> = [predicateParts objectForKey:CPRuleEditorPredicateOperatorType],</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        options  = [predicateParts objectForKey:CPRuleEditorPredicateOptions],</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        modifier = [predicateParts objectForKey:CPRuleEditorPredicateComparisonModifier],</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        selector = <a class="code" href="_c_p_obj_j_runtime_8j.html#a45a81e40ed0e7efe7ef3958151d548d8">CPSelectorFromString</a>([predicateParts objectForKey:<a class="code" href="_c_p_rule_editor___constants_8j.html#aa470c0bcaa9f333e73a0cdc688b37e0a">CPRuleEditorPredicateCustomSelector</a>]);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span> (lhs === nil)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        CPLogConsole(<span class="stringliteral">@&quot;missing left expression in predicate parts dictionary&quot;</span>);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">if</span> (rhs === nil)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        CPLogConsole(<span class="stringliteral">@&quot;missing right expression in predicate parts dictionary&quot;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">if</span> (selector === nil &amp;&amp; <span class="keyword">operator</span> === nil)</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        CPLogConsole(<span class="stringliteral">@&quot;missing operator and selector in predicate parts dictionary&quot;</span>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> (modifier === nil)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        CPLogConsole(<span class="stringliteral">@&quot;missing modifier in predicate parts dictionary. Setting default: CPDirectPredicateModifier&quot;</span>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (options === nil)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        CPLogConsole(<span class="stringliteral">@&quot;missing options in predicate parts dictionary. Setting default: CPCaseInsensitivePredicateOption&quot;</span>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">try</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">if</span> (selector !== nil)</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            predicate = [<a class="code" href="interface_c_p_comparison_predicate.html" title="CPComparisonPredicate is a subclass of CPPredicate used to compare expressions. ">CPComparisonPredicate</a> <a class="code" href="interface_c_p_comparison_predicate.html#ac9ce9475b500f393c5c08175d241bc13">predicateWithLeftExpression</a>:lhs</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                                           <a class="code" href="interface_c_p_comparison_predicate.html#ac9ce9475b500f393c5c08175d241bc13">rightExpression</a>:rhs</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                                            <a class="code" href="interface_c_p_comparison_predicate.html#ac9ce9475b500f393c5c08175d241bc13">customSelector</a>:selector</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                         ];</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            predicate = [<a class="code" href="interface_c_p_comparison_predicate.html" title="CPComparisonPredicate is a subclass of CPPredicate used to compare expressions. ">CPComparisonPredicate</a> <a class="code" href="interface_c_p_comparison_predicate.html#a0fe06837ef0bdca7d956b5a3dbb106ff">predicateWithLeftExpression</a>:lhs</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                                           <a class="code" href="interface_c_p_comparison_predicate.html#a0fe06837ef0bdca7d956b5a3dbb106ff">rightExpression</a>:rhs</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                                                  <a class="code" href="interface_c_p_comparison_predicate.html#a0fe06837ef0bdca7d956b5a3dbb106ff">modifier</a>:(modifier || CPDirectPredicateModifier)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                                                      <a class="code" href="interface_c_p_comparison_predicate.html#a0fe06837ef0bdca7d956b5a3dbb106ff">type</a>:operator</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                                                   <a class="code" href="interface_c_p_comparison_predicate.html#a0fe06837ef0bdca7d956b5a3dbb106ff">options</a>:(options || CPCaseInsensitivePredicateOption)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                         ];</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">catch</span>(error)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        CPLogConsole(<span class="stringliteral">@&quot;Row predicate error: [&quot;</span> + [error description] + <span class="stringliteral">&quot;] for row &quot;</span> + aRow);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        predicate = nil;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">finally</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">return</span> predicate;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;}</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a7cb12c750dba72a2fde4381196fc9670">  936</a></span>&#160;- (Class)rowClass</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;{</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">return</span> _rowClass;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;}</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ad0d157a7419ad7565ae1ee1c55831159">  946</a></span>&#160;- (void)setRowClass:(Class)rowClass</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;{</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">if</span> (rowClass === [<a class="code" href="class_c_p_mutable_dictionary.html">CPMutableDictionary</a> <span class="keyword">class</span>])</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        rowClass = [_CPRuleEditorRowObject class];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    _rowClass = rowClass;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;}</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a079ccb1df55a9934047f997dd4cb7d89">  961</a></span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)rowTypeKeyPath</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;{</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">return</span> _typeKeyPath;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a4a2f92c68a2557bbda9043c1aebffe70">  971</a></span>&#160;- (void)setRowTypeKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)keyPath</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;{</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">if</span> (_typeKeyPath !== keyPath)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        _typeKeyPath = keyPath;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;}</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a03eb2788d9e734c2d5f5ae0ea7fad915">  984</a></span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)subrowsKeyPath</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;{</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">return</span> _subrowsArrayKeyPath;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;}</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#ab39a711be94dd69a5b01fa8017fc0e31">  994</a></span>&#160;- (void)setSubrowsKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)keyPath</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;{</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span> (_subrowsArrayKeyPath !== keyPath)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        _subrowsArrayKeyPath = keyPath;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a7b2faa7adc58818f421c617f126a6b81"> 1007</a></span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)criteriaKeyPath</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;{</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">return</span> _itemsKeyPath;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#afced97317edde73ac7ac6c645f8d560c"> 1017</a></span>&#160;- (void)setCriteriaKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)keyPath</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;{</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (_itemsKeyPath !== keyPath)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        _itemsKeyPath = keyPath;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;}</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01030"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a71427d897024abe12d723df0d5df0476"> 1030</a></span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)displayValuesKeyPath</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;{</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">return</span> _valuesKeyPath;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;}</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a858f75ab9952269cb90b751c9342f554"> 1040</a></span>&#160;- (void)setDisplayValuesKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)keyPath</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;{</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span> (_valuesKeyPath !== keyPath)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        _valuesKeyPath = keyPath;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a0956e828dcaaff915b25afa9d930494f"> 1055</a></span>&#160;- (id)animation</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;{</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">return</span> _currentAnimation;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;}</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01066"></a><span class="lineno"><a class="code" href="interface_c_p_rule_editor.html#a17beeb329df57596fe313a53b4639eac"> 1066</a></span>&#160;- (void)setAnimation:(<a class="code" href="interface_c_p_view_animation.html">CPViewAnimation</a>)animation</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;{</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    _currentAnimation = animation;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    [_currentAnimation setDelegate:self];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;}</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;- (BOOL)acceptsFirstResponder</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;}</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;- (void)keyDown:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;{</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (!_suppressKeyDownHandling &amp;&amp; [<span class="keyword">self</span> _applicableNestingMode] === <a class="code" href="_c_p_rule_editor___constants_8j.html#a2a2a2daaeed7ae8098015683fbe9a8cd">CPRuleEditorNestingModeCompound</a> &amp;&amp; !_isKeyDown &amp;&amp; ([event modifierFlags] &amp; <a class="code" href="_c_p_event___constants_8j.html#abb24a409c7daa575dd1fa20b7fcf8d51">CPAlternateKeyMask</a>))</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        [_slices makeObjectsPerformSelector:@selector(_configurePlusButtonByRowType:) withObject:CPRuleEditorRowTypeCompound];</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    _isKeyDown = YES;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;- (void)keyUp:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;{</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">if</span> (!_suppressKeyDownHandling)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        [_slices makeObjectsPerformSelector:@selector(_configurePlusButtonByRowType:) withObject:CPRuleEditorRowTypeSimple];</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    _isKeyDown = NO;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;- (_CPRuleEditorViewSliceDropSeparator)_createSliceDropSeparator</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;{</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    var view = [[_CPRuleEditorViewSliceDropSeparator alloc] initWithFrame:CGRectMake(0, -10, [<span class="keyword">self</span> frame].size.width, 2)];</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    [view setAutoresizingMask:CPViewWidthSizable];</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">return</span> view;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;- (BOOL)_suppressKeyDownHandling</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;{</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> _suppressKeyDownHandling;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;- (BOOL)_wantsRowAnimations</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;{</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">return</span> (_currentAnimation !== nil);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;}</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;- (void)_updateButtonVisibilities</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;{</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    [_slices makeObjectsPerformSelector:@selector(_updateButtonVisibilities)];</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;- (float)_alignmentGridWidth</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;{</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">return</span>  _alignmentGridWidth;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;}</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;- (float)_minimumFrameHeight</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;{</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">return</span> 26.;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;}</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;- (CPRuleEditorNestingMode)_applicableNestingMode</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;{</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span> (!_nestingModeDidChange)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">return</span> _nestingMode;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    var a = (_nestingMode === <a class="code" href="_c_p_rule_editor___constants_8j.html#a2a2a2daaeed7ae8098015683fbe9a8cd">CPRuleEditorNestingModeCompound</a> || _nestingMode === <a class="code" href="_c_p_rule_editor___constants_8j.html#a6e943a157b214510f90ee395c7c5f246">CPRuleEditorNestingModeSimple</a>),</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        b = ([<span class="keyword">self</span> rowTypeForRow:0] === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (a === b)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        <span class="keywordflow">return</span> _nestingMode;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">return</span> a ? <a class="code" href="_c_p_rule_editor___constants_8j.html#abc68a04af6ac9e1280f2087c8e9d3e2f">CPRuleEditorNestingModeList</a> : <a class="code" href="_c_p_rule_editor___constants_8j.html#a6e943a157b214510f90ee395c7c5f246">CPRuleEditorNestingModeSimple</a>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;}</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;- (BOOL)_shouldHideAddButtonForSlice:(<span class="keywordtype">id</span>)slice</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;{</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">return</span> (!_editable || [<span class="keyword">self</span> _applicableNestingMode] === <a class="code" href="_c_p_rule_editor___constants_8j.html#ae08c736e778a1a4411ebcef390bfb791">CPRuleEditorNestingModeSingle</a>);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;}</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;- (BOOL)_shouldHideSubtractButtonForSlice:(<span class="keywordtype">id</span>)slice</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;{</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">if</span> (!_editable)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (!_disallowEmpty)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">return</span> NO;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    var shouldHide,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        rowIndex = [slice rowIndex],</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        parentIndex = [<span class="keyword">self</span> parentRowForRow:rowIndex],</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        subrowsIndexes = [<span class="keyword">self</span> subrowIndexesForRow:parentIndex],</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        nestingMode = [<span class="keyword">self</span> _applicableNestingMode];</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">switch</span> (nestingMode)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#a2a2a2daaeed7ae8098015683fbe9a8cd">CPRuleEditorNestingModeCompound</a>:</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#a6e943a157b214510f90ee395c7c5f246">CPRuleEditorNestingModeSimple</a>: shouldHide = ([subrowsIndexes count] === 1 &amp;&amp; !_allowsEmptyCompoundRows) || parentIndex === -1;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#abc68a04af6ac9e1280f2087c8e9d3e2f">CPRuleEditorNestingModeList</a>: shouldHide = ([<span class="keyword">self</span> numberOfRows] === 1);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="_c_p_rule_editor___constants_8j.html#ae08c736e778a1a4411ebcef390bfb791">CPRuleEditorNestingModeSingle</a>: shouldHide = YES;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="keywordflow">default</span>: shouldHide = NO;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span> shouldHide;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="preprocessor">#pragma mark Rows management</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;- (id)_rowCacheForIndex:(<span class="keywordtype">int</span>)index</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;{</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">return</span> [_rowCache objectAtIndex:index];</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;- (id)_searchCacheForRowObject:(<span class="keywordtype">id</span>)rowObject</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    var count = [_rowCache count],</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        i;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         var cache = _rowCache[i];</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         <span class="keywordflow">if</span> ([cache rowObject] === rowObject)</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;              <span class="keywordflow">return</span> cache;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">return</span> nil;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;}</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;- (int)_rowIndexForRowObject:(<span class="keywordtype">id</span>)rowobject</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;{</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (rowobject === _boundArrayOwner)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">return</span> [[<span class="keyword">self</span> _searchCacheForRowObject:rowobject] rowIndex]; <span class="comment">// Pas bon car le rowIndex du row cache n&#39;est pas synchro avec la position dans _rowCache.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;- (<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a>)_subrowObjectsOfObject:(<span class="keywordtype">id</span>)object</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;{</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">object</span> === _boundArrayOwner)</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">return</span> [<span class="keyword">self</span> _rootRowsArray];</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">return</span> [object mutableArrayValueForKey:_subrowsArrayKeyPath];</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)_childlessParentsIfSlicesWereDeletedAtIndexes:(<span class="keywordtype">id</span>)indexes</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;{</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    var childlessParents = [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>],</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        current_index = [indexes firstIndex];</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        var parentIndex = [<span class="keyword">self</span> parentRowForRow:current_index],</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            subrowsIndexes = [<span class="keyword">self</span> subrowIndexesForRow:parentIndex];</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordflow">if</span> ([subrowsIndexes count] === 1)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keywordflow">if</span> (parentIndex !== -1)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                <span class="keywordflow">return</span> [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:0];</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            var childlessGranPa = [<span class="keyword">self</span> _childlessParentsIfSlicesWereDeletedAtIndexes:[<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:parentIndex]];</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            [childlessParents addIndexes:childlessGranPa];</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        current_index = [indexes indexGreaterThanIndex:current_index];</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    }</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">return</span> childlessParents;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">// (id)-[RuleEditor _includeSubslicesForSlicesAtIndexes:]</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;}</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)_includeSubslicesForSlicesAtIndexes:(<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)indexes</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;{</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    var subindexes = [indexes <a class="code" href="interface_c_p_index_set.html#a90dc099b597c7bdfcd18c8b7d51e7ca1">copy</a>],</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        current_index = [indexes <a class="code" href="interface_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>];</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        var sub = [<span class="keyword">self</span> subrowIndexesForRow:current_index];</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        [subindexes addIndexes:[<span class="keyword">self</span> _includeSubslicesForSlicesAtIndexes:sub]];</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        current_index = [indexes <a class="code" href="interface_c_p_index_set.html#a3f66583eea02c42c2b14e53daf697559">indexGreaterThanIndex</a>:current_index];</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">return</span> subindexes;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;}</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;- (void)_deleteSlice:(<span class="keywordtype">id</span>)slice</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;{</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    var rowindexes = [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:[slice rowIndex]];</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keywordflow">if</span> (!_allowsEmptyCompoundRows)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        var childlessIndexes = [<span class="keyword">self</span> _childlessParentsIfSlicesWereDeletedAtIndexes:rowindexes];</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">if</span> ([childlessIndexes count] &gt; 0)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            rowindexes = childlessIndexes;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    [<span class="keyword">self</span> removeRowsAtIndexes:rowindexes includeSubrows:YES];</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    [<span class="keyword">self</span> _updatePredicate];</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    [<span class="keyword">self</span> _sendRuleAction];</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    [<span class="keyword">self</span> _postRuleOptionChangedNotification];</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    [<span class="keyword">self</span> _postRowCountChangedNotificationOfType:CPRuleEditorRowsDidChangeNotification indexes:rowindexes];</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;}</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;- (CPArray)_rootRowsArray</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;{</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> [_boundArrayOwner mutableArrayValueForKey:_boundArrayKeyPath];</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;}</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;- (BOOL)_nextUnusedItems:(CPArray)items andValues:(CPArray)values forRow:(CPInteger)rowIndex forRowType:(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)type</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;{</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    var parentItem = [items lastObject], <span class="comment">// if empty items array, this is NULL aka the root item;</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        childrenCount = [<span class="keyword">self</span> _queryNumberOfChildrenOfItem:parentItem withRowType:type],</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        foundIndex = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">if</span> (childrenCount === 0)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">return</span> NO;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    var current_criterions = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        count = [<span class="keyword">self</span> numberOfRows],</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        row;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">for</span> (row = 0; row &lt; count; row++) <span class="comment">// num of rows should be num of siblings of parentItem</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        var aCriteria = [<span class="keyword">self</span> criteriaForRow:row],</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            itemIndex = [items count];</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">if</span> ([<span class="keyword">self</span> rowTypeForRow:row] === type &amp;&amp; itemIndex &lt; [aCriteria count])</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            var crit = [aCriteria objectAtIndex:itemIndex];</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            [current_criterions addObject:crit];</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">while</span> (foundIndex === <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        var buffer = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> arrayWithArray:current_criterions],</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            i;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; childrenCount; i++)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            var child =  [<span class="keyword">self</span> _queryChild:i ofItem:parentItem withRowType:type];</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <span class="keywordflow">if</span> ([current_criterions indexOfObject:child] === <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                foundIndex = i;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">if</span> (foundIndex === <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="keywordflow">for</span> (var k = 0; k &lt; childrenCount; k++)</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                var anobject = [<span class="keyword">self</span> _queryChild:k ofItem:parentItem withRowType:type],</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                    index = [buffer indexOfObject:anobject];</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                <span class="keywordflow">if</span> (index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                    [buffer removeObjectAtIndex:index];</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            current_criterions = buffer;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    var foundItem = [<span class="keyword">self</span> _queryChild:foundIndex ofItem:parentItem withRowType:type],</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        foundValue = [<span class="keyword">self</span> _queryValueForItem:foundItem inRow:rowIndex];</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    [items addObject:foundItem];</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    [values addObject:foundValue];</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;}</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;- (<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a>)_getItemsAndValuesToAddForRow:(CPInteger)rowIndex ofType:(CPRuleEditorRowType)type</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;{</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">//var cachedItemsAndValues = _itemsAndValuesToAddForRowType[type];</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">//if (cachedItemsAndValues)</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">//    return cachedItemsAndValues;</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    var itemsAndValues = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        items = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        values = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        unusedItems = YES;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordflow">while</span> (unusedItems)</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        unusedItems = [<span class="keyword">self</span> _nextUnusedItems:items andValues:values forRow:rowIndex forRowType:type];</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    var count = [items count];</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        var item = [items objectAtIndex:i],</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            value = [values objectAtIndex:i],</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            itemAndValue = @{</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    <span class="stringliteral">&quot;item&quot;</span>: item,</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                    <span class="stringliteral">&quot;value&quot;</span>: value,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                };</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        [itemsAndValues addObject:itemAndValue];</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">return</span> itemsAndValues;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;}</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;- (void)_addOptionFromSlice:(<span class="keywordtype">id</span>)slice ofRowType:(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)type</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;{</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">// for CPRuleEditorNestingModeSimple only</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    var rowIndexEvent = [slice rowIndex],</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        rowTypeEvent = [<span class="keyword">self</span> rowTypeForRow:rowIndexEvent],</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        insertIndex = rowIndexEvent + 1,</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        parentRowIndex = (rowTypeEvent === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>) ? rowIndexEvent:[self parentRowForRow:rowIndexEvent];</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    [<span class="keyword">self</span> insertRowAtIndex:insertIndex withType:type asSubrowOfRow:parentRowIndex animate:YES];</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;}</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;- (id)_insertNewRowAtIndex:(<span class="keywordtype">int</span>)insertIndex ofType:(CPRuleEditorRowType)rowtype withParentRow:(CPInteger)parentRowIndex</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;{</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    var row = [[[<span class="keyword">self</span> rowClass] alloc] init],</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        itemsandvalues = [<span class="keyword">self</span> _getItemsAndValuesToAddForRow:insertIndex ofType:rowtype],</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        newitems = [itemsandvalues valueForKey:@&quot;item&quot;],</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        newvalues = [itemsandvalues valueForKey:@&quot;value&quot;];</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    [row setValue:newitems forKey:_itemsKeyPath];</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    [row setValue:newvalues forKey:_valuesKeyPath];</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    [row setValue:rowtype forKey:_typeKeyPath];</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    [row setValue:[<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array] forKey:_subrowsArrayKeyPath];</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    var subrowsObjects;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> (parentRowIndex === -1 || [<span class="keyword">self</span> _applicableNestingMode] === <a class="code" href="_c_p_rule_editor___constants_8j.html#abc68a04af6ac9e1280f2087c8e9d3e2f">CPRuleEditorNestingModeList</a>)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        subrowsObjects = [<span class="keyword">self</span> _rootRowsArray];</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        var parentRowObject = [[<span class="keyword">self</span> _rowCacheForIndex:parentRowIndex] rowObject];</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        subrowsObjects = [<span class="keyword">self</span> _subrowObjectsOfObject:parentRowObject];</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    var relInsertIndex = insertIndex - parentRowIndex - 1;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    [subrowsObjects insertObject:row atIndex:relInsertIndex];</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    [<span class="keyword">self</span> _updatePredicate];</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    [<span class="keyword">self</span> _sendRuleAction];</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    [<span class="keyword">self</span> _postRuleOptionChangedNotification];</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    [<span class="keyword">self</span> _postRowCountChangedNotificationOfType:CPRuleEditorRowsDidChangeNotification indexes:[<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:insertIndex]];</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">return</span> row;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;}</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor">#pragma mark Key value observing</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;- (void)_startObservingRowObjectsRecursively:(CPArray)rowObjects</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;{</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    [_boundArrayOwner addObserver:self forKeyPath:_boundArrayKeyPath options:CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew context:boundArrayContext];</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    var count = [rowObjects count];</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        var rowObject = [rowObjects objectAtIndex:i];</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        [rowObject addObserver:self forKeyPath:_itemsKeyPath options:CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew context:itemsContext];</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        [rowObject addObserver:self forKeyPath:_valuesKeyPath options:CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew context:valuesContext];</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        [rowObject addObserver:self forKeyPath:_subrowsArrayKeyPath options:CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew context:subrowsContext];</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        var subrows = [<span class="keyword">self</span> _subrowObjectsOfObject:rowObject];</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">if</span> ([subrows count] &gt; 0)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            [<span class="keyword">self</span> _startObservingRowObjectsRecursively:subrows];</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">// ORIG IMPL : calls +keyPathsForValuesAffectingValueForKey: for all keys</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;}</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;- (void)_stopObservingRowObjectsRecursively:(CPArray)rowObjects</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;{</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    [_boundArrayOwner removeObserver:self forKeyPath:_boundArrayKeyPath];</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    var count = [rowObjects count];</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        var rowObject = [rowObjects objectAtIndex:i];</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        [rowObject removeObserver:self forKeyPath:_itemsKeyPath];</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        [rowObject removeObserver:self forKeyPath:_valuesKeyPath];</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        [rowObject removeObserver:self forKeyPath:_subrowsArrayKeyPath];</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        var subrows = [rowObject valueForKey:_subrowsArrayKeyPath];</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <span class="keywordflow">if</span> ([subrows count] &gt; 0)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            [<span class="keyword">self</span> _stopObservingRowObjectsRecursively:subrows];</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;}</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;- (void)observeValueForKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)keypath ofObject:(<span class="keywordtype">id</span>)object change:(<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)change context:(<span class="keywordtype">void</span>)context</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;{</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    var changeKind = [change <a class="code" href="interface_c_p_dictionary.html#a3c517acf439ab37a112456000fea7a9b">objectForKey</a>:CPKeyValueChangeKindKey],</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        changeNewValue = [change <a class="code" href="interface_c_p_dictionary.html#a3c517acf439ab37a112456000fea7a9b">objectForKey</a>:CPKeyValueChangeNewKey],</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        changeOldValue = [change <a class="code" href="interface_c_p_dictionary.html#a3c517acf439ab37a112456000fea7a9b">objectForKey</a>:CPKeyValueChangeOldKey],</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        newRows,</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        oldRows;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keywordflow">if</span> (context === <a class="code" href="_c_p_rule_editor_8j.html#a8bff62fe6dcb4cc807b1a93164e5c46e">boundArrayContext</a> || context === <a class="code" href="_c_p_rule_editor_8j.html#a79dc5a73dd1ef67aa8ee8c953188cfee">subrowsContext</a>)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">if</span> (changeKind === <a class="code" href="_c_p_key_value_observing_8j.html#ab38f2aa9a0051d00c8f26a6e0242de3c">CPKeyValueChangeSetting</a>)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            newRows = changeNewValue;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            oldRows = changeOldValue;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (changeKind === <a class="code" href="_c_p_key_value_observing_8j.html#a0ec9dcd852629ef5bb58f3f3ef252b9f">CPKeyValueChangeInsertion</a>)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            newRows = [<span class="keyword">self</span> _subrowObjectsOfObject:object];</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            oldRows = [CPArray arrayWithArray:newRows];</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            [oldRows removeObjectsInArray:changeNewValue];</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        [<span class="keyword">self</span> _changedRowArray:newRows withOldRowArray:oldRows forParent:object];</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        [<span class="keyword">self</span> _reconfigureSubviewsAnimate:[<span class="keyword">self</span> _wantsRowAnimations]];</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;}</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;- (void)_changedItem:(<span class="keywordtype">id</span>)fromItem toItem:(<span class="keywordtype">id</span>)toItem inRow:(CPInteger)aRow atCriteriaIndex:(<span class="keywordtype">int</span>)fromItemIndex</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;{</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    var criteria = [<span class="keyword">self</span> criteriaForRow:aRow],</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        displayValues = [<span class="keyword">self</span> displayValuesForRow:aRow],</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        rowType = [<span class="keyword">self</span> rowTypeForRow:aRow],</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        anItem = toItem,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        items = [criteria subarrayWithRange:CPMakeRange(0, fromItemIndex)],</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        values = [displayValues subarrayWithRange:CPMakeRange(0, fromItemIndex)];</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    _lastRow = aRow;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">while</span> (YES)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    {</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        [items addObject:anItem];</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        var value = [<span class="keyword">self</span> _queryValueForItem:anItem inRow:aRow];</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        [values addObject:value];</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keywordflow">if</span> (![<span class="keyword">self</span> _queryNumberOfChildrenOfItem:anItem withRowType:rowType])</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        anItem = [<span class="keyword">self</span> _queryChild:0 ofItem:anItem withRowType:rowType];</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    }</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    var <span class="keywordtype">object</span> = [[<span class="keyword">self</span> _rowCacheForIndex:aRow] rowObject];</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    [object setValue:items forKey:_itemsKeyPath];</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    [object setValue:values forKey:_valuesKeyPath];</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    var slice = [_slices objectAtIndex:aRow];</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    [slice _reconfigureSubviews];</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    [<span class="keyword">self</span> _updatePredicate];</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    [<span class="keyword">self</span> _sendRuleAction];</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    [<span class="keyword">self</span> _postRuleOptionChangedNotification];</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;}</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;- (void)_changedRowArray:(CPArray)newRows withOldRowArray:(CPArray)oldRows forParent:(<span class="keywordtype">id</span>)parentRowObject</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;{</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    var newRowCount = [newRows count],</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        oldRowCount = [oldRows count],</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        deltaCount = newRowCount - oldRowCount,</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        minusCount = MIN(newRowCount, oldRowCount),</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        maxCount = MAX(newRowCount, oldRowCount),</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        insertCacheIndexes = [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> indexSet],</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        newCaches = [CPArray array],</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        parentCacheIndentation,</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        parentCacheIndex = [self _rowIndexForRowObject:parentRowObject],</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        newRowCacheIndex = 0,</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        changeStartIndex = 0;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    [<span class="keyword">self</span> _stopObservingRowObjectsRecursively:oldRows];</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    [<span class="keyword">self</span> _startObservingRowObjectsRecursively:newRows];</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">//var gindexes = [self _globalIndexesForSubrowIndexes:[CPIndexSet indexSetWithIndexesInRange:CPMakeRange(0,oldRowCount)] ofParentObject:parentRowObject];</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordflow">if</span> (parentCacheIndex === -1)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        parentCacheIndentation = -1;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        parentCacheIndentation = [[<span class="keyword">self</span> _rowCacheForIndex:parentCacheIndex] indentation];</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">for</span> (; newRowCacheIndex &lt; newRowCount; newRowCacheIndex++)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        var newCacheGlobalIndex = (parentCacheIndex + 1) + newRowCacheIndex,</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            obj = [newRows objectAtIndex:newRowCacheIndex],</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            newRowType = [obj valueForKey:_typeKeyPath],</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            cache = [[_CPRuleEditorCache alloc] init];</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        [cache setRowObject:obj];</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        [cache setRowIndex:newCacheGlobalIndex];</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        [cache setIndentation:parentCacheIndentation + 1];</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        [insertCacheIndexes addIndex:newCacheGlobalIndex];</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        [newCaches addObject:cache];</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">//var lastCacheIndex = [self _rowIndexForRowObject:[oldRows lastObject]];</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    [_rowCache removeObjectsInRange:CPMakeRange(parentCacheIndex + 1, [oldRows count])];</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    [_rowCache insertObjects:newCaches atIndexes:insertCacheIndexes];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">for</span> (; changeStartIndex &lt; minusCount; changeStartIndex++)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        var oldrow = [oldRows objectAtIndex:changeStartIndex],</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            newrow = [newRows objectAtIndex:changeStartIndex];</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <span class="keywordflow">if</span> (newrow !== oldrow)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    var replaceCount = (deltaCount === 0) ? maxCount : maxCount - minusCount,</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        startIndex = parentCacheIndex + changeStartIndex + 1;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">if</span> (deltaCount &lt;= 0)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    {</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        var removeIndexes = [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(startIndex, replaceCount)],</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            removeSlices = [_slices objectsAtIndexes:removeIndexes];</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        [removeSlices makeObjectsPerformSelector:@selector(removeFromSuperview)];</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        [_slices removeObjectsAtIndexes:removeIndexes];</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">if</span> (deltaCount &gt;= 0)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        var newIndentation = parentCacheIndentation + 1,</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            newIndex = startIndex;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="keywordflow">for</span> (; newIndex &lt; startIndex + replaceCount; newIndex++)</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            var newslice = [<span class="keyword">self</span> _newSlice],</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                rowType = [<span class="keyword">self</span> rowTypeForRow:newIndex];</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            [newslice setRowIndex:newIndex];</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            [newslice setIndentation:newIndentation];</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            [newslice _setRowType:rowType];</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            [newslice _configurePlusButtonByRowType:CPRuleEditorRowTypeSimple];</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            [_slices insertObject:newslice atIndex:newIndex];</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    var emptyArray = [CPArray array],</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        count = [oldRows count],</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        n;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; count; n++)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        var oldRow = [oldRows objectAtIndex:n],</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            subOldRows = [<span class="keyword">self</span> _subrowObjectsOfObject:oldRow];</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">if</span> ([subOldRows count] &gt; 0)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            [<span class="keyword">self</span> _changedRowArray:emptyArray withOldRowArray:subOldRows forParent:oldRow];</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    count = [newRows count];</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; count; n++)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        var newRow = [newRows objectAtIndex:n],</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            subnewRows = [<span class="keyword">self</span> _subrowObjectsOfObject:newRow];</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        <span class="keywordflow">if</span> ([subnewRows count] &gt; 0)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            [<span class="keyword">self</span> _changedRowArray:subnewRows withOldRowArray:emptyArray forParent:newRow];</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;}</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;- (void)bind:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)aBinding toObject:(<span class="keywordtype">id</span>)observableController withKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)aKeyPath options:(<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)options</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;{</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordflow">if</span> ([aBinding isEqualToString:<span class="stringliteral">@&quot;rows&quot;</span>])</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    [<span class="keyword">self</span> unbind:aBinding];</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    [<span class="keyword">self</span> _setBoundDataSource:observableController withKeyPath:aKeyPath options:options];</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    [_rowCache removeAllObjects];</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    [_slices removeAllObjects];</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    var newRows = [CPArray array],</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        oldRows = [<span class="keyword">self</span> _rootRowsArray];</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    [<span class="keyword">self</span> _changedRowArray:newRows withOldRowArray:oldRows forParent:_boundArrayOwner];</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    [<span class="keyword">super</span> bind:aBinding toObject:observableController withKeyPath:aKeyPath options:options];</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;}</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;- (void)unbind:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)object</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;{</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    _rowClass = [_CPRuleEditorRowObject class];</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    [<span class="keyword">super</span> unbind:object];</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;}</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;- (void)_setBoundDataSource:(<span class="keywordtype">id</span>)datasource withKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)keyPath options:(<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)options</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;{</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> ([datasource respondsToSelector:<span class="keyword">@selector</span>(objectClass)])</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        _rowClass = [datasource objectClass];</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    _boundArrayKeyPath = keyPath;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    _boundArrayOwner = datasource;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">//var boundRows = [_boundArrayOwner valueForKey:_boundArrayKeyPath];</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    [_boundArrayOwner addObserver:self forKeyPath:_boundArrayKeyPath options:CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew context:boundArrayContext];</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">//if ([boundRows isKindOfClass:[CPArray class]] &amp;&amp; [boundRows count] &gt; 0)</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">//    [_boundArrayOwner setValue:boundRows forKey:_boundArrayKeyPath];</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;}</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;- (void)_setPredicate:(CPPredicate)predicate</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;{</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> (_predicate !== predicate)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        _predicate = predicate;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;}</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;- (void)_updatePredicate</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;{</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> (_delegateWantsValidation)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">if</span> (![<span class="keyword">self</span> _delegateRespondsToRuleEditorPredicatePartsForCriterionWithDisplayValueInRow])</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        _delegateWantsValidation = NO;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    var subpredicates = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        subindexes = [<span class="keyword">self</span> subrowIndexesForRow:-1],</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        current_index = [subindexes firstIndex];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        var subpredicate = [<span class="keyword">self</span> predicateForRow:current_index];</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">if</span> (subpredicate !== nil)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            [subpredicates addObject:subpredicate];</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        current_index = [subindexes indexGreaterThanIndex:current_index];</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    var new_predicate = [[<a class="code" href="interface_c_p_compound_predicate.html" title="CPCompoundPredicate is a subclass of CPPredicate used to represent logical gate operations (AND/OR/...">CPCompoundPredicate</a> alloc] initWithType:CPOrPredicateType subpredicates:subpredicates];</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    [<span class="keyword">self</span> _setPredicate:new_predicate];</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;}</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;- (_CPRuleEditorViewSliceRow)_newSlice</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;{</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    var sliceRect = CGRectMake(0, 0, CGRectGetWidth([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]), 0),</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        slice = [<span class="keyword">self</span> _createNewSliceWithFrame:sliceRect ruleEditorView:self];</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">return</span> slice;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;}</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;- (_CPRuleEditorViewSliceRow)_createNewSliceWithFrame:(CGRect)frame ruleEditorView:(<a class="code" href="interface_c_p_rule_editor.html" title="A view for creating and configuring criteria. ">CPRuleEditor</a>)editor</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;{</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">return</span> [[_CPRuleEditorViewSliceRow alloc] initWithFrame:frame ruleEditorView:editor];</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;}</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;- (void)_reconfigureSubviewsAnimate:(BOOL)animate</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;{</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    var viewAnimations = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        added_slices = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        count = [_slices count];</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    [<span class="keyword">self</span> _updateSliceRows];</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">if</span> ([[<span class="keyword">self</span> superview] isKindOfClass:[<a class="code" href="interface_c_p_clip_view.html">CPClipView</a> <span class="keyword">class</span>]])</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        [<span class="keyword">self</span> setFrameSize:CGSizeMake(CGRectGetWidth([<span class="keyword">self</span> frame]), count * _sliceHeight)];</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        var aslice = [_slices objectAtIndex:i],</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            targetRect = [aslice _animationTargetRect],</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            startRect = [aslice frame],</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            startIndex = [aslice rowIndex] - 1;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordflow">if</span> ([aslice superview] === nil)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        {</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            startRect = CGRectMake(0, startIndex * _sliceHeight, CGRectGetWidth(startRect), _sliceHeight);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            [aslice _reconfigureSubviews];</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            [added_slices addObject:aslice];</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">if</span> (animate)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            var animation = @{};</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            [animation setObject:aslice forKey:CPViewAnimationTargetKey];</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            [animation setObject:startRect forKey:CPViewAnimationStartFrameKey];</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            [animation setObject:targetRect forKey:CPViewAnimationEndFrameKey];</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            [viewAnimations insertObject:animation atIndex:0];</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            [aslice setFrame:targetRect];</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    var addcount = [added_slices count];</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; addcount; i++)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        [_slicesHolder addSubview:added_slices[i] positioned:CPWindowBelow relativeTo:nil];</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">if</span> (animate)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        [_currentAnimation setViewAnimations:viewAnimations];</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        [_currentAnimation startAnimation];</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    }</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    _lastRow = [<span class="keyword">self</span> numberOfRows] - 1;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">if</span> (_lastRow === -1)</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        _nestingModeDidChange = NO;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    [<span class="keyword">self</span> setNeedsDisplay:YES];</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    [_slices makeObjectsPerformSelector:@selector(_updateButtonVisibilities)];</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;}</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;- (void)animationDidEnd:(<a class="code" href="interface_c_p_view_animation.html">CPViewAnimation</a>)animation</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;{</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">//  var nextSimple = [self _getItemsAndValuesToAddForRow:0 ofType:CPRuleEditorRowTypeSimple],</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">//      nextCompound = [self _getItemsAndValuesToAddForRow:0 ofType:CPRuleEditorRowTypeCompound];</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">//  _itemsAndValuesToAddForRowType = {CPRuleEditorRowTypeSimple:nextSimple, CPRuleEditorRowTypeCompound:nextCompound};</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;}</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;- (void)_updateSliceRows</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;{</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    var <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a> =  [<span class="keyword">self</span> frame].size.width,</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        count = [_slices count];</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        var slice = [_slices objectAtIndex:i],</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            targetRect = CGRectMake(0, i * _sliceHeight, width, _sliceHeight);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        [slice setRowIndex:i];</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        [slice _setAnimationTargetRect:targetRect];</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;}</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;- (CPArray)_backgroundColors</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;{</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;alternating-row-colors&quot;];</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;}</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;- (<a class="code" href="interface_c_p_color.html">CPColor</a>)_selectedRowColor</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;{</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;selected-color&quot;];</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;}</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;- (<a class="code" href="interface_c_p_color.html">CPColor</a>)_sliceTopBorderColor</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;{</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;slice-top-border-color&quot;];</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;}</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;- (<a class="code" href="interface_c_p_color.html">CPColor</a>)_sliceBottomBorderColor</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;{</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;slice-bottom-border-color&quot;];</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;}</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;- (<a class="code" href="interface_c_p_color.html">CPColor</a>)_sliceLastBottomBorderColor</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;{</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;slice-last-bottom-border-color&quot;];</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;}</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;- (<a class="code" href="interface_c_p_font.html">CPFont</a>)font</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;{</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;font&quot;];</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;}</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;- (<a class="code" href="interface_c_p_color.html">CPColor</a>)_fontColor</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;{</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;font-color&quot;];</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;- (<a class="code" href="interface_c_p_image.html">CPImage</a>)_imageAdd</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;{</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;add-image&quot; inState:CPThemeStateNormal];</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;}</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;- (<a class="code" href="interface_c_p_image.html">CPImage</a>)_imageAddHighlighted</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;{</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;add-image&quot; inState:CPThemeStateHighlighted];</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;}</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;- (<a class="code" href="interface_c_p_image.html">CPImage</a>)_imageRemove</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;{</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;remove-image&quot; inState:CPThemeStateNormal];</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;}</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;- (<a class="code" href="interface_c_p_image.html">CPImage</a>)_imageRemoveHighlighted</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;{</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;remove-image&quot; inState:CPThemeStateHighlighted];</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;}</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;- (CPVerticalTextAlignment)_verticalAlignment</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;{</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> valueForThemeAttribute:@&quot;vertical-alignment&quot;];</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;}</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)_toolTipForAddCompoundRowButton</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;{</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">return</span> [_standardLocalizer localizedStringForString:@&quot;Add compound row&quot;];</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;}</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)_toolTipForAddSimpleRowButton</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;{</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">return</span> [_standardLocalizer localizedStringForString:@&quot;Add row&quot;];</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;}</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)_toolTipForDeleteRowButton</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;{</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordflow">return</span> [_standardLocalizer localizedStringForString:@&quot;Delete row&quot;];</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;}</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;- (void)_updateSliceIndentations</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    [<span class="keyword">self</span> _updateSliceIndentationAtIndex:0 toIndentation:0 withIndexSet:[<span class="keyword">self</span> subrowIndexesForRow:0]];</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;}</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;- (void)_updateSliceIndentationAtIndex:(<span class="keywordtype">int</span>)index toIndentation:(<span class="keywordtype">int</span>)indentation withIndexSet:(<span class="keywordtype">id</span>)indexes</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;{</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    var current_index = [indexes firstIndex];</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        var subindexes = [<span class="keyword">self</span> subrowIndexesForRow:index];</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        [<span class="keyword">self</span> _updateSliceIndentationAtIndex:current_index toIndentation:indentation + 1 withIndexSet:subindexes];</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        current_index = [indexes indexGreaterThanIndex:current_index];</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    }</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    [[_slices objectAtIndex:index] setIndentation:indentation];</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;}</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;- (CPArray)_selectedSlices</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;{</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    var _selectedSlices = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        count = [_slices count],</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        i;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        var slice = _slices[i];</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="keywordflow">if</span> ([slice _isSelected])</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            [_selectedSlices addObject:slice];</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">return</span> _selectedSlices;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;}</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;- (int)_lastSelectedSliceIndex</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;{</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    var lastIndex = -1,</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        count = [_slices count],</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        i;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         var slice = _slices[i];</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;         <span class="keywordflow">if</span> ([slice _isLastSelected])</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            <span class="keywordflow">return</span> [slice rowIndex];</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;- (void)_mouseUpOnSlice:(<span class="keywordtype">id</span>)slice withEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;{</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">if</span> ([slice _rowType] !== <a class="code" href="_c_p_rule_editor___constants_8j.html#a049ce9c9baea351773da40b980e9ebb8">CPRuleEditorRowTypeSimple</a>)</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    var modifierFlags = [event <a class="code" href="interface_c_p_event.html#ae1990580a2f73b19009f30f27ff1e396">modifierFlags</a>],</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        extend = (modifierFlags &amp; <a class="code" href="_c_p_event___constants_8j.html#a675a3ab6cfc14dd4ad6702d7c682c7fe">CPCommandKeyMask</a>) || (modifierFlags &amp; <a class="code" href="_c_p_event___constants_8j.html#a2343191b34b38dc1952bb44d83fa30d6">CPShiftKeyMask</a>),</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        rowIndexes = [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> indexSetWithIndex:[slice rowIndex]];</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    [<span class="keyword">self</span> selectRowIndexes:rowIndexes byExtendingSelection:extend];</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;}</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;- (void)_mouseDownOnSlice:(<span class="keywordtype">id</span>)slice withEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;{</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;}</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;- (void)_rightMouseDownOnSlice:(_CPRuleEditorViewSlice)slice withEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;{</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;}</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;- (void)_performClickOnSlice:(<span class="keywordtype">id</span>)slice withEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;{</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;}</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;- (void)_setSuppressKeyDownHandling:(BOOL)flag</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;{</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    _suppressKeyDownHandling = flag;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;}</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;- (void)selectAll:(<span class="keywordtype">id</span>)sender</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;{</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    var count = [_slices count];</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordflow">while</span> (count--)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        var slice = _slices[count];</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        [slice _setSelected:YES];</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        [slice setNeedsDisplay:YES];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;}</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;- (void)_deselectAll</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;{</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    var count = [_slices count];</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">while</span> (count--)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        var slice = _slices[count];</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        [slice _setSelected:NO];</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        [slice _setLastSelected:NO];</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        [slice setNeedsDisplay:YES];</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    }</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;}</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;- (int)_queryNumberOfChildrenOfItem:(<span class="keywordtype">id</span>)item withRowType:(CPRuleEditorRowType)type</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;{</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">return</span> [_ruleDelegate ruleEditor:self numberOfChildrenForCriterion:item withRowType:type];</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;}</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;- (id)_queryChild:(<span class="keywordtype">int</span>)childIndex ofItem:(<span class="keywordtype">id</span>)item withRowType:(CPRuleEditorRowType)type</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;{</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordflow">return</span> [_ruleDelegate ruleEditor:self child:childIndex forCriterion:item withRowType:type];</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;}</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;- (id)_queryValueForItem:(<span class="keywordtype">id</span>)item inRow:(CPInteger)row</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;{</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">return</span> [_ruleDelegate ruleEditor:self displayValueForCriterion:item inRow:row];</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;}</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;- (int)_lastRow</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;{</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="keywordflow">return</span> _lastRow;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;}</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;- (int)_countOfRowsStartingAtObject:(<span class="keywordtype">id</span>)object</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;{</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    var index = [<span class="keyword">self</span> _rowIndexForRowObject:object];</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">return</span> ([<span class="keyword">self</span> numberOfRows] - index);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;}</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;- (void)_setAlignmentGridWidth:(<span class="keywordtype">float</span>)width</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;{</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    _alignmentGridWidth = <a class="code" href="_c_p_segmented_control_8j.html#a2474a5474cbff19523a51eb1de01cda4">width</a>;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;}</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;- (BOOL)_validateItem:(<span class="keywordtype">id</span>)item value:(<span class="keywordtype">id</span>)value inRow:(CPInteger)row</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;{</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">return</span> [<span class="keyword">self</span> _queryCanSelectItem:item displayValue:value inRow:row];</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;}</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;- (BOOL)_queryCanSelectItem:(<span class="keywordtype">id</span>)item displayValue:(<span class="keywordtype">id</span>)value inRow:(CPInteger)row</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;{</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;}</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;- (void)_windowChangedKeyState</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;{</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    [<span class="keyword">self</span> setNeedsDisplay:YES];</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;}</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;- (void)<a class="code" href="_c_a_layer_8j.html#a6f851b517537a61e53381475cb1b52f1">setNeedsDisplay</a>:(BOOL)flag</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;{</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    [_slices makeObjectsPerformSelector:@selector(setNeedsDisplay:) withObject:flag];</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    [<span class="keyword">super</span> setNeedsDisplay:flag];</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;}</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;- (void)setFrameSize:(CGSize)size</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;{</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    [<span class="keyword">self</span> setNeedsDisplay:YES];</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">if</span> (CGRectGetWidth([<span class="keyword">self</span> <a class="code" href="_c_p_segmented_control_8j.html#a63fcc9e0dd97e8502cce685e88234e16">frame</a>]) !== size.width)</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        [_slices makeObjectsPerformSelector:<span class="keyword">@selector</span>(setNeedsLayout)];</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    [super setFrameSize:size];</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;}</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)_selectedSliceIndices</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;{</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    var selectedIndices = [<a class="code" href="class_c_p_mutable_index_set.html">CPMutableIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>],</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        count = [_slices count],</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        i;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; count; i++)</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        var slice = _slices[i];</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="keywordflow">if</span> ([slice _isSelected])</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            [selectedIndices addIndex:[slice rowIndex]];</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">return</span> selectedIndices;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;}</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;- (void)mouseDragged:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;{</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">if</span> (!_editable)</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    var point = [<span class="keyword">self</span> convertPoint:[event <a class="code" href="interface_c_p_event.html#a5a57f4fa909de5d83e5402a8d8af4b94">locationInWindow</a>] fromView:nil],</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        view = [_slices objectAtIndex:FLOOR(point.y / _sliceHeight)];</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">if</span> ([<span class="keyword">self</span> _dragShouldBeginFromMouseDown:view])</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        [<span class="keyword">self</span> _performDragForSlice:view withEvent:event];</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;}</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;- (BOOL)_dragShouldBeginFromMouseDown:(<a class="code" href="interface_c_p_view.html">CPView</a>)view</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;{</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <span class="keywordflow">return</span> (([<span class="keyword">self</span> nestingMode] === <a class="code" href="_c_p_rule_editor___constants_8j.html#abc68a04af6ac9e1280f2087c8e9d3e2f">CPRuleEditorNestingModeList</a> ||  [view rowIndex] !== 0) &amp;&amp; _editable &amp;&amp; [view isKindOfClass:[_CPRuleEditorViewSliceRow <span class="keyword">class</span>]] &amp;&amp; _draggingRows === nil);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;}</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;- (BOOL)_performDragForSlice:(<span class="keywordtype">id</span>)slice withEvent:(<a class="code" href="interface_c_p_event.html">CPEvent</a>)event</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;{</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    var dragPoint,</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        mainRowIndex = [slice rowIndex],</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        draggingRows = [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:mainRowIndex],</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        selected_indices = [<span class="keyword">self</span> _selectedSliceIndices],</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        pasteboard = [<a class="code" href="interface_c_p_pasteboard.html">CPPasteboard</a> <a class="code" href="interface_c_p_pasteboard.html#adc671279bc4d0608ebe421e4657ecd07">pasteboardWithName</a>:CPDragPboard];</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    [pasteboard declareTypes:[CPArray arrayWithObjects:CPRuleEditorItemPBoardType, nil] owner: self];</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordflow">if</span> ([selected_indices containsIndex:mainRowIndex])</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        [draggingRows addIndexes:selected_indices];</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    _draggingRows = [<span class="keyword">self</span> _includeSubslicesForSlicesAtIndexes:draggingRows];</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    var firstIndex = [_draggingRows firstIndex],</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        firstSlice = [_slices objectAtIndex:firstIndex],</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        dragview = [[<a class="code" href="interface_c_p_view.html">CPView</a> <a class="code" href="class_c_p_object.html#aa6d290852c6a151058e8e82d053db475">alloc</a>] initWithFrame:[firstSlice frame]];</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="preprocessor">#if PLATFORM(DOM)</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="preprocessor"></span>    var html = firstSlice._DOMElement.innerHTML;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    dragview._DOMElement.innerHTML = [html copy];</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="preprocessor"></span>    [dragview setBackgroundColor:[firstSlice backgroundColor]];</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    [dragview setAlphaValue:0.7];</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    dragPoint = CGPointMake(0, firstIndex * _sliceHeight);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    [<span class="keyword">self</span> dragView:dragview</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                at:dragPoint</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            offset:CGSizeMake(0, _sliceHeight)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;             event:event</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        pasteboard:pasteboard</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            source:self</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;         slideBack:YES];</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;}</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;- (CPDragOperation)draggingEntered:(<span class="keywordtype">id</span> <span class="comment">/*&lt; CPDraggingInfo &gt;*/</span>)sender</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;{</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">if</span> ([sender draggingSource] === <span class="keyword">self</span>)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        [<span class="keyword">self</span> _clearDropLine];</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_c_p_drag_server___constants_8j.html#aea93033cd818a14176498cf7923ba8e5">CPDragOperationMove</a>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    }</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_c_p_drag_server___constants_8j.html#a4c8a51b72ef80d850f6d42fc94223ec5">CPDragOperationNone</a>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;}</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;- (void)draggingExited:(<span class="keywordtype">id</span>)sender</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;{</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    [<span class="keyword">self</span> _clearDropLine];</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    [<span class="keyword">self</span> setNeedsDisplay:YES];</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;}</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;- (void)_clearDropLine</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;{</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    [_dropLineView setAlphaValue:0];</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">if</span> (_subviewIndexOfDropLine !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a> &amp;&amp; _subviewIndexOfDropLine &lt; _lastRow)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        var previousBelowSlice = [_slices objectAtIndex:_subviewIndexOfDropLine];</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        [previousBelowSlice setFrameOrigin:CGPointMake(0, [previousBelowSlice rowIndex] * _sliceHeight)];</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    _subviewIndexOfDropLine = <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;}</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;- (CPDragOperation)draggingUpdated:(<span class="keywordtype">id</span> <span class="comment">/*&lt;CPDraggingInfo&gt;*/</span>)sender</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;{</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    var point = [<span class="keyword">self</span> convertPoint:[sender draggingLocation] fromView:nil],</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        y = point.y + _sliceHeight / 2,</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        indexOfDropLine =  FLOOR(y / _sliceHeight),</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        numberOfRows = [self numberOfRows];</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">if</span> (indexOfDropLine &lt;= 0 || indexOfDropLine &gt; numberOfRows || (indexOfDropLine &gt;= [_draggingRows firstIndex] &amp;&amp; indexOfDropLine &lt;= [_draggingRows lastIndex] + 1))</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        <span class="keywordflow">if</span> (_subviewIndexOfDropLine !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a> &amp;&amp; indexOfDropLine !== _subviewIndexOfDropLine)</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            [<span class="keyword">self</span> _clearDropLine];</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_c_p_drag_server___constants_8j.html#a4c8a51b72ef80d850f6d42fc94223ec5">CPDragOperationNone</a>;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordflow">if</span> (_subviewIndexOfDropLine !== indexOfDropLine)</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        <span class="keywordflow">if</span> (_subviewIndexOfDropLine !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a> &amp;&amp; _subviewIndexOfDropLine &lt; numberOfRows)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            var previousBelowSlice = [_slices objectAtIndex:_subviewIndexOfDropLine];</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            [previousBelowSlice setFrameOrigin:CGPointMake(0, [previousBelowSlice rowIndex] * _sliceHeight)];</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="keywordflow">if</span> (indexOfDropLine &lt;= _lastRow &amp;&amp; indexOfDropLine &lt; numberOfRows)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            var belowSlice = [_slices objectAtIndex:indexOfDropLine];</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            [belowSlice setFrameOrigin:CGPointMake(0, [belowSlice rowIndex] * _sliceHeight + 2)];</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        }</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        [_dropLineView setAlphaValue:1];</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        [_dropLineView setFrameOrigin:CGPointMake(CGRectGetMinX([_dropLineView frame]), indexOfDropLine * _sliceHeight)];</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        _subviewIndexOfDropLine = indexOfDropLine;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_c_p_drag_server___constants_8j.html#aea93033cd818a14176498cf7923ba8e5">CPDragOperationMove</a>;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;}</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;- (BOOL)prepareForDragOperation:(<span class="keywordtype">id</span> <span class="comment">/*&lt; CPDraggingInfo &gt;*/</span>)sender</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;{</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">return</span> (_subviewIndexOfDropLine !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;}</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;- (BOOL)performDragOperation:(<span class="keywordtype">id</span> <span class="comment">/*&lt; CPDraggingInfo &gt;*/</span>)info</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;{</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    var aboveInsertIndexCount = 0,</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        object,</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        removeIndex;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    var rowObjects = [_rowCache valueForKey:@&quot;rowObject&quot;],</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        index = [_draggingRows lastIndex];</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    var parentRowIndex = [<span class="keyword">self</span> parentRowForRow:index], <span class="comment">// first index of draggingrows</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        parentRowObject = (parentRowIndex === -1) ? _boundArrayOwner : [[self _rowCacheForIndex:parentRowIndex] rowObject],</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        insertIndex = _subviewIndexOfDropLine;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keywordflow">while</span> (index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    {</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        <span class="keywordflow">if</span> (index &gt;= insertIndex)</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        {</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            removeIndex = index + aboveInsertIndexCount;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            aboveInsertIndexCount += 1;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            removeIndex = index;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            insertIndex -= 1;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="keywordtype">object</span> = [rowObjects objectAtIndex:removeIndex];</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        [<span class="keyword">self</span> removeRowAtIndex:removeIndex];</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        [[<span class="keyword">self</span> _subrowObjectsOfObject:parentRowObject] insertObject:object atIndex:insertIndex - parentRowIndex - 1];</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        index = [_draggingRows indexLessThanIndex:index];</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    }</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    [<span class="keyword">self</span> _clearDropLine];</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    _draggingRows = nil;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;}</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)_draggingTypes</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;{</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keywordflow">return</span> [<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4aa683fde78ba593d0e70040125ed306">indexSetWithIndex</a>:CPDragOperationMove];</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;}</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;- (void)draggedView:(<a class="code" href="interface_c_p_view.html">CPView</a>)dragView endedAt:(CGPoint)aPoint operation:(CPDragOperation)operation</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;{</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    _draggingRows = nil;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    [<span class="keyword">self</span> _updatePredicate];</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    [<span class="keyword">self</span> _sendRuleAction];</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    [<span class="keyword">self</span> _postRuleOptionChangedNotification];</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    [<span class="keyword">self</span> _postRowCountChangedNotificationOfType:CPRuleEditorRowsDidChangeNotification indexes:nil]; <span class="comment">// FIXME</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;}</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;- (BOOL)wantsPeriodicDraggingUpdates</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;{</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">return</span> NO;</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;}</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;- (void)pasteboard:(<a class="code" href="interface_c_p_pasteboard.html">CPPasteboard</a>)pasteboard provideDataForType:(<span class="keywordtype">int</span>)type</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;{</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;}</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;- (void)_setWindow:(<a class="code" href="interface_c_p_window.html">CPWindow</a>)window</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;{</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    [<span class="keyword">super</span> _setWindow:window];</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;}</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;- (void)_windowUpdate:(<span class="keywordtype">id</span>)sender</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;{</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    [<span class="keyword">super</span> _windowUpdate:sender];</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;}</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;- (void)_postRuleOptionChangedNotification</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;{</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    [[<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects. ">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="interface_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">postNotificationName</a>:CPRuleEditorRulesDidChangeNotification <a class="code" href="interface_c_p_notification_center.html#ac9402b295db607cbd92ae56bce50b37f">object</a>:self];</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;}</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;- (void)_postRowCountChangedNotificationOfType:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)notificationName indexes:indexes</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;{</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    var userInfo = indexes === nil ? @{} : @{ <span class="stringliteral">&quot;indexes&quot;</span>: indexes };</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    [[<a class="code" href="interface_c_p_notification_center.html" title="Sends messages (CPNotification) between objects. ">CPNotificationCenter</a> <a class="code" href="interface_c_p_notification_center.html#a5abe725f1a1a48ac4cb1e45b6d9d50a8">defaultCenter</a>] <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">postNotificationName</a>:notificationName <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">object</a>:self <a class="code" href="interface_c_p_notification_center.html#ac5e7dc8d0972292f52736f6f662bb25a">userInfo</a>:userInfo];</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;}</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;- (<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)_globalIndexesForSubrowIndexes:(<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a>)indexes ofParentObject:(<span class="keywordtype">id</span>)parentRowObject</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;{</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    var _subrows = [<span class="keyword">self</span> _subrowObjectsOfObject:parentRowObject],</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        parentRowIndex = [<span class="keyword">self</span> _rowIndexForRowObject:parentRowObject],</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        globalIndexes = [<a class="code" href="class_c_p_mutable_index_set.html">CPMutableIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a339845eb2d96fae878209105dde5e140">indexSet</a>],</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        current_index = [indexes <a class="code" href="interface_c_p_index_set.html#abc895f4b5df7bdaf090161db6b234b73">firstIndex</a>],</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        numberOfChildrenOfPreviousBrother = 0;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keywordflow">while</span> (current_index !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a>)</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        var globalChildIndex = current_index + parentRowIndex + 1 + numberOfChildrenOfPreviousBrother;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        [globalIndexes addIndex:globalChildIndex];</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <span class="keywordflow">if</span> ([<span class="keyword">self</span> rowTypeForRow:globalChildIndex] === <a class="code" href="_c_p_rule_editor___constants_8j.html#afd1c6ac76a4b959512fab136eab67b7e">CPRuleEditorRowTypeCompound</a>)</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            var rowObject = [[<span class="keyword">self</span> _rowCacheForIndex:current_index] rowObject],</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                subrows = [<span class="keyword">self</span> _subrowObjectsOfObject:rowObject],</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                subIndexes = [<span class="keyword">self</span> _globalIndexesForSubrowIndexes:[<a class="code" href="interface_c_p_index_set.html" title="A collection of unique integers. ">CPIndexSet</a> <a class="code" href="interface_c_p_index_set.html#a4c32a454bd5323253b9e8c4f81712ea5">indexSetWithIndexesInRange</a>:CPMakeRange(0, [subrows count])] ofParentObject:rowObject];</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            numberOfChildrenOfPreviousBrother = [subIndexes count];</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        current_index = [indexes <a class="code" href="interface_c_p_index_set.html#a3f66583eea02c42c2b14e53daf697559">indexGreaterThanIndex</a>:current_index];</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">return</span> globalIndexes;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;}</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;- (void)_sendRuleAction</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;{</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    var action = [<span class="keyword">self</span> action],</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        target = [<span class="keyword">self</span> target];</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    [<span class="keyword">self</span> sendAction:action to:target];</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;}</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;- (BOOL)_sendsActionOnIncompleteTextChange</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;{</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="keywordflow">return</span> YES;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;}</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;- (void)_getAllAvailableItems:(<span class="keywordtype">id</span>)items values:(<span class="keywordtype">id</span>)values asChildrenOfItem:(<span class="keywordtype">id</span>)parentItem inRow:(CPInteger)aRow</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;{</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;    var type,</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        indexofCriterion,</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        numOfChildren;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    var availItems = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array],</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        availValues = [<a class="code" href="interface_c_p_mutable_array.html">CPMutableArray</a> array];</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    var criterion = nil,</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        value = nil;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    _lastRow = aRow;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    type = [<span class="keyword">self</span> rowTypeForRow:aRow];</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    numOfChildren = [<span class="keyword">self</span> _queryNumberOfChildrenOfItem:parentItem withRowType:type];</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    var criteria = [<span class="keyword">self</span> criteriaForRow:aRow];</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    indexofCriterion = [criteria indexOfObject:criterion];</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="keywordflow">if</span> (parentItem !== nil</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        &amp;&amp; indexofCriterion !== <a class="code" href="_c_p_obj_j_runtime_8j.html#a84e3be579b365cc2c1559e1a1f469238">CPNotFound</a></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        &amp;&amp; indexofCriterion &lt; [criteria count] - 1)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    {</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        var next = indexofCriterion + 1;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        criterion = [criteria objectAtIndex:next];</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        var values = [<span class="keyword">self</span> displayValuesForRow:aRow];</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        value = [values objectAtIndex:next];</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    }</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="keywordflow">for</span> (var i = 0; i &lt; numOfChildren; ++i)</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    {</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        var aChild = [<span class="keyword">self</span> _queryChild:i ofItem:parentItem withRowType:type],</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            availChild = aChild,</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;            availValue = value;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="keywordflow">if</span> (criterion !== aChild)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            availValue = [<span class="keyword">self</span> _queryValueForItem:aChild inRow:aRow];</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">if</span> (!availValue)</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;            availValue = [<span class="keyword">self</span> _queryValueForItem:availChild inRow:aRow];</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        [availItems addObject:availChild];</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        [availValues addObject:availValue];</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    }</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    [items addObjectsFromArray:availItems];</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    [values addObjectsFromArray:availValues];</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;}</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="keyword">@implementation </span>CPRuleEditor (CPRuleEditorDelegate)</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;- (BOOL)_delegateRespondsToRuleEditorPredicatePartsForCriterionWithDisplayValueInRow</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;{</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordflow">return</span> _implementedDelegateMethods &amp; <a class="code" href="_c_p_rule_editor_8j.html#a1c48877b4b05217ad6dc324164abb241">CPRuleEditorDelegate_ruleEditor_predicatePartsForCriterion_withDisplayValue_inRow_</a>;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;}</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;- (<a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>)_sendDelegateRuleEditorPredicatePartsForCriterion:(<span class="keywordtype">id</span>)criterion withDisplayValue:(<span class="keywordtype">id</span>)value inRow:(CPInteger)row</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;{</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keywordflow">if</span> (!(_implementedDelegateMethods &amp; <a class="code" href="_c_p_rule_editor_8j.html#a1c48877b4b05217ad6dc324164abb241">CPRuleEditorDelegate_ruleEditor_predicatePartsForCriterion_withDisplayValue_inRow_</a>))</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="keywordflow">return</span> @{};</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keywordflow">return</span> [_ruleDelegate ruleEditor:self predicatePartsForCriterion:criterion withDisplayValue:value inRow:row];</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;}</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;var CPRuleEditorAlignmentGridWidthKey       = <span class="stringliteral">@&quot;CPRuleEditorAlignmentGridWidth&quot;</span>,</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    CPRuleEditorSliceHeightKey              = <span class="stringliteral">@&quot;CPRuleEditorSliceHeight&quot;</span>,</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    CPRuleEditorStringsFilenameKey          = <span class="stringliteral">@&quot;CPRuleEditorStringsFilename&quot;</span>,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    CPRuleEditorEditableKey                 = <span class="stringliteral">@&quot;CPRuleEditorEditable&quot;</span>,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    CPRuleEditorAllowsEmptyCompoundRowsKey  = <span class="stringliteral">@&quot;CPRuleEditorAllowsEmptyCompoundRows&quot;</span>,</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    CPRuleEditorDisallowEmptyKey            = <span class="stringliteral">@&quot;CPRuleEditorDisallowEmpty&quot;</span>,</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    CPRuleEditorNestingModeKey              = <span class="stringliteral">@&quot;CPRuleEditorNestingMode&quot;</span>,</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    CPRuleEditorRowTypeKeyPathKey           = <span class="stringliteral">@&quot;CPRuleEditorRowTypeKeyPath&quot;</span>,</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    CPRuleEditorItemsKeyPathKey             = <span class="stringliteral">@&quot;CPRuleEditorItemsKeyPath&quot;</span>,</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    CPRuleEditorValuesKeyPathKey            = <span class="stringliteral">@&quot;CPRuleEditorValuesKeyPath&quot;</span>,</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    CPRuleEditorSubrowsArrayKeyPathKey      = <span class="stringliteral">@&quot;CPRuleEditorSubrowsArrayKeyPath&quot;</span>,</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    CPRuleEditorBoundArrayKeyPathKey        = <span class="stringliteral">@&quot;CPRuleEditorBoundArrayKeyPath&quot;</span>,</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    CPRuleEditorRowClassKey                 = <span class="stringliteral">@&quot;CPRuleEditorRowClass&quot;</span>,</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    CPRuleEditorSlicesHolderKey             = <span class="stringliteral">@&quot;CPRuleEditorSlicesHolder&quot;</span>,</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    CPRuleEditorSlicesKey                   = <span class="stringliteral">@&quot;CPRuleEditorSlices&quot;</span>,</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    CPRuleEditorDelegateKey                 = <span class="stringliteral">@&quot;CPRuleEditorDelegate&quot;</span>,</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    CPRuleEditorBoundArrayOwnerKey          = <span class="stringliteral">@&quot;CPRuleEditorBoundArrayOwner&quot;</span>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="keyword">@implementation </span>CPRuleEditor (CPCoding)</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;- (id)initWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding). ">CPCoder</a>)coder</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;{</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithCoder:coder];</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span> !== nil)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        [<span class="keyword">self</span> setFormattingStringsFilename:[coder decodeObjectForKey:CPRuleEditorStringsFilenameKey]];</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        _alignmentGridWidth      = [coder decodeFloatForKey:CPRuleEditorAlignmentGridWidthKey];</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        _sliceHeight             = [coder decodeDoubleForKey:CPRuleEditorSliceHeightKey];</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        _editable                = [coder decodeBoolForKey:CPRuleEditorEditableKey];</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        _allowsEmptyCompoundRows = [coder decodeBoolForKey:CPRuleEditorAllowsEmptyCompoundRowsKey];</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        _disallowEmpty           = [coder decodeBoolForKey:CPRuleEditorDisallowEmptyKey];</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        _nestingMode             = [coder decodeIntForKey:CPRuleEditorNestingModeKey];</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        _typeKeyPath             = [coder decodeObjectForKey:CPRuleEditorRowTypeKeyPathKey];</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        _itemsKeyPath            = [coder decodeObjectForKey:CPRuleEditorItemsKeyPathKey];</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        _valuesKeyPath           = [coder decodeObjectForKey:CPRuleEditorValuesKeyPathKey];</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        _subrowsArrayKeyPath     = [coder decodeObjectForKey:CPRuleEditorSubrowsArrayKeyPathKey];</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        _boundArrayKeyPath       = [coder decodeObjectForKey:CPRuleEditorBoundArrayKeyPathKey];</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        _slicesHolder = [[<span class="keyword">self</span> subviews] objectAtIndex:0];</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        _boundArrayOwner = [coder decodeObjectForKey:CPRuleEditorBoundArrayOwnerKey];</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        _slices = [coder decodeObjectForKey:CPRuleEditorSlicesKey];</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        _ruleDelegate = [coder decodeObjectForKey:CPRuleEditorDelegateKey];</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        [<span class="keyword">self</span> _initRuleEditorShared];</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;}</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;- (void)encodeWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding). ">CPCoder</a>)coder</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;{</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    [<span class="keyword">super</span> encodeWithCoder:coder];</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    [coder encodeBool:_editable forKey:CPRuleEditorEditableKey];</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    [coder encodeBool:_allowsEmptyCompoundRows forKey:CPRuleEditorAllowsEmptyCompoundRowsKey];</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    [coder encodeBool:_disallowEmpty forKey:CPRuleEditorDisallowEmptyKey];</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    [coder encodeFloat:_alignmentGridWidth forKey:CPRuleEditorAlignmentGridWidthKey];</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    [coder encodeDouble:_sliceHeight forKey:CPRuleEditorSliceHeightKey];</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    [coder encodeInt:_nestingMode forKey:CPRuleEditorNestingModeKey];</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    [coder encodeObject:_stringsFilename forKey:CPRuleEditorStringsFilenameKey];</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    [coder encodeObject:_typeKeyPath forKey:CPRuleEditorRowTypeKeyPathKey];</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    [coder encodeObject:_itemsKeyPath forKey:CPRuleEditorItemsKeyPathKey];</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    [coder encodeObject:_valuesKeyPath forKey:CPRuleEditorValuesKeyPathKey];</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    [coder encodeObject:_boundArrayKeyPath forKey:CPRuleEditorBoundArrayKeyPathKey];</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    [coder encodeObject:_subrowsArrayKeyPath forKey:CPRuleEditorSubrowsArrayKeyPathKey];</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    [coder encodeConditionalObject:_slicesHolder forKey:CPRuleEditorSlicesHolderKey];</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    [coder encodeObject:_slices forKey:CPRuleEditorSlicesKey];</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    [coder encodeObject:_boundArrayOwner forKey:CPRuleEditorBoundArrayOwnerKey];</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;}</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;var CriteriaKey         = <span class="stringliteral">@&quot;criteria&quot;</span>,</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    SubrowsKey          = <span class="stringliteral">@&quot;subrows&quot;</span>,</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    DisplayValuesKey    = <span class="stringliteral">@&quot;displayValues&quot;</span>,</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    RowTypeKey          = <span class="stringliteral">@&quot;rowType&quot;</span>;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="keyword">@implementation </span>_CPRuleEditorRowObject : <a class="code" href="class_c_p_object.html">CPObject</a></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;{</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    CPArray     subrows;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    CPArray     criteria;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    CPArray     displayValues;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    CPInteger   rowType;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;}</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;- (id)copy</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;{</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    var copy = [[_CPRuleEditorRowObject alloc] init];</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    [copy setSubrows:[[CPArray alloc] initWithArray:subrows copyItems:YES]];</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    [copy setCriteria:[[CPArray alloc] initWithArray:criteria copyItems:YES]];</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    [copy setDisplayValues:[[CPArray alloc] initWithArray:displayValues copyItems:YES]];</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    [copy setRowType:rowType];</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <span class="keywordflow">return</span> copy;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;}</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)description</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;{</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;&quot;</span> + [self className] + &quot;&gt;\nsubrows = &quot; + [subrows description] + &quot;\ncriteria = &quot; + [criteria description] + &quot;\ndisplayValues = &quot; + [displayValues description];</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;}</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;- (id)initWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding). ">CPCoder</a>)coder</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;{</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span> !== nil)</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    {</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        subrows = [coder decodeObjectForKey:SubrowsKey];</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        criteria = [coder decodeObjectForKey:CriteriaKey];</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        displayValues = [coder decodeObjectForKey:DisplayValuesKey];</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        rowType = [coder decodeIntForKey:RowTypeKey];</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;}</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;- (void)encodeWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding). ">CPCoder</a>)coder</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;{</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    [coder encodeObject:subrows forKey:SubrowsKey];</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    [coder encodeObject:criteria forKey:CriteriaKey];</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    [coder encodeObject:displayValues forKey:DisplayValuesKey];</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    [coder encodeInt:rowType forKey:RowTypeKey];</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;}</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="keyword">@implementation </span>_CPRuleEditorCache : <a class="code" href="class_c_p_object.html">CPObject</a></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;{</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <a class="code" href="interface_c_p_dictionary.html" title="A mutable key-value pair collection. ">CPDictionary</a>    rowObject;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    CPInteger       rowIndex;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    CPInteger       indentation;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;}</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)description</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;{</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordflow">return</span> [<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a> <a class="code" href="interface_c_p_string.html#a7d9e7b4329b51daf0c3b43d6183d4eec">stringWithFormat</a>:@&quot;&lt;%d object:%d rowIndex:%d indentation:%d&gt;&quot;, [<span class="keyword">self</span> hash], [rowObject hash], rowIndex, indentation];</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;}</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;var CPBoundArrayKey = <span class="stringliteral">@&quot;CPBoundArray&quot;</span>;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="keyword">@implementation </span>_CPRuleEditorViewUnboundRowHolder : <a class="code" href="class_c_p_object.html">CPObject</a></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;{</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    CPArray boundArray;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;}</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;- (id)<a class="code" href="_c_a_layer_8j.html#a4213bb26f5207ee3f402fe463badc691">init</a></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;{</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span> = [super <a class="code" href="_c_a_layer_8j.html#a4213bb26f5207ee3f402fe463badc691">init</a>])</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        boundArray = [[CPArray alloc] init];</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;}</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;- (id)initWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding). ">CPCoder</a>)coder</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;{</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">self</span> = [super <a class="code" href="_c_a_layer_8j.html#a4213bb26f5207ee3f402fe463badc691">init</a>])</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        boundArray = [coder decodeObjectForKey:CPBoundArrayKey];</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">self</span>;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;}</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;- (void)encodeWithCoder:(<a class="code" href="interface_c_p_coder.html" title="Defines methods for use when archiving &amp; restoring (enc/decoding). ">CPCoder</a>)coder</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;{</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    [coder encodeObject:boundArray forKey:CPBoundArrayKey];</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;}</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="keyword">@implementation </span>_CPRuleEditorViewSliceHolder : <a class="code" href="interface_c_p_view.html">CPView</a></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;{</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="keywordtype">id</span> __doxygen__;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;}</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;- (void)addSubview:(<a class="code" href="interface_c_p_view.html">CPView</a>)subview</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;{</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    [<span class="keyword">self</span> setNeedsDisplay:YES];</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    [<span class="keyword">super</span> addSubview:subview];</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;}</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;var dropSeparatorColor = [<a class="code" href="interface_c_p_color.html">CPColor</a> <a class="code" href="interface_c_p_color.html#a80c4273ef2d3bb9cc836946de79c8a1e">colorWithHexString</a>:@&quot;4886ca&quot;];</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="keyword">@implementation </span>_CPRuleEditorViewSliceDropSeparator : <a class="code" href="interface_c_p_view.html">CPView</a></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;{</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordtype">id</span> __doxygen__;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;}</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;- (void)drawRect:(CGRect)rect</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;{</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    var context = [[<a class="code" href="interface_c_p_graphics_context.html">CPGraphicsContext</a> <a class="code" href="interface_c_p_graphics_context.html#a378dafc8fb951053dd6877fb45e87f61">currentContext</a>] <a class="code" href="interface_c_p_graphics_context.html#a92895bd939c04da463d02425bec83f0b">graphicsPort</a>];</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <a class="code" href="group__coregraphics.html#ga800a3e5b0c46359d28b091376630bb0e">CGContextSetFillColor</a>(context, dropSeparatorColor);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    <a class="code" href="group__coregraphics.html#ga74c13e165c00cc434a54bb8c2148e1ba">CGContextFillRect</a>(context, [<span class="keyword">self</span> <a class="code" href="_c_a_layer_8j.html#a76e98e4f35c628cffcb1a388ec583bec">bounds</a>]);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;}</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="keyword">@implementation </span>CPObject (CPRuleEditorSliceRow)</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;- (int)valueType</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;{</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    var result = 0,</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        isString = [<span class="keyword">self</span> isKindOfClass:CPString];</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">if</span> (!isString)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    {</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        var isView = [<span class="keyword">self</span> isKindOfClass:CPView];</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        result = 1;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="keywordflow">if</span> (!isView)</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        {</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            var ismenuItem = [<span class="keyword">self</span> isKindOfClass:CPMenuItem];</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            result = 2;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">if</span> (!ismenuItem)</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                [<a class="code" href="interface_c_p_exception.html" title="Used to implement exception handling (creating &amp; raising). ">CPException</a> <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">raise</a>:CPGenericException <a class="code" href="interface_c_p_exception.html#ac8f34bd11868822e26a7b952810128b8">reason</a>:@&quot;Unknown type for &quot; + self];</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                result = -1;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;            }</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        }</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;}</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="keyword">@end</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="keyword">@implementation </span>CPRuleEditor (CPSynthesizedAccessors)</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;- (<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)boundArrayKeyPath</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;{</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    <span class="keywordflow">return</span> _boundArrayKeyPath;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;}</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;- (void)setBoundArrayKeyPath:(<a class="code" href="interface_c_p_string.html" title="An immutable string (collection of characters). ">CPString</a>)aValue</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;{</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    _boundArrayKeyPath = aValue;</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;}</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;- (_CPRuleEditorLocalizer)standardLocalizer</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;{</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <span class="keywordflow">return</span> _standardLocalizer;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;}</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;- (void)setStandardLocalizer:(_CPRuleEditorLocalizer)aValue</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;{</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    _standardLocalizer = aValue;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;}</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="keyword">@end</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0e4e8176c2dd688a0cdab60948de03e6.html">AppKit</a></li><li class="navelem"><a class="el" href="dir_fc132eb981070bff01114b7499547a3a.html">CPRuleEditor</a></li><li class="navelem"><a class="el" href="_c_p_rule_editor_8j.html">CPRuleEditor.j</a></li>
    <li class="footer">Generated on Sun Mar 29 2015 14:04:30 for API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
